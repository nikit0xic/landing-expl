/*! For license information please see a83d2ad0.27470811.js.LICENSE.txt */
"use strict";(self.webpackChunkvkwidgets=self.webpackChunkvkwidgets||[]).push([[6250],{88882:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,{AuthQR:()=>pt,Config:()=>Ae,Connect:()=>ot});var o=["vk.com","vk.ru"],i=["agreements","promo","vkc_behavior","vkc_auth_action","vkc_brand","vkc_display_mode","service_groups","external_device_id"],a=!("undefined"==typeof window||!window.document||!window.document.createElement),s=a&&!!window.addEventListener,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function l(e,t){return e(t={exports:{}},t.exports),t.exports}var p=u(l((function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}))),d=function(){};if(s)try{var h=Object.defineProperty({},"passive",{get:function(){}});window.addEventListener("test",d,h),window.removeEventListener("test",d,h)}catch(r){}!function(){if(!a)return!1;try{document.createElement("div").scrollTo({top:0,get behavior(){return!0,"smooth"}})}catch(e){}}();var f=l((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0}));u(f);var m=l((function(e){e.exports=function(e){if(Array.isArray(e))return f(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));u(m);var v=l((function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));u(v);var g=l((function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));u(g);var _=l((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));u(_),u(l((function(e){e.exports=function(e){return m(e)||v(e)||g(e)||_()},e.exports.default=e.exports,e.exports.__esModule=!0})));var y=u(l((function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0})));function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var E={parse:function(e){if("string"!=typeof e)return{};if(!(e=e.trim().replace(/^[?#&]/,"")))return{};var t=/\?(.+)$/gi.exec(e);return(t?t[1]:e).split("&").reduce((function(e,t){var n=t.split("=");return n[1]&&(e[n[0]]=decodeURIComponent(n[1])),e}),{})},stringify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==p(e)||null===e)return"";t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({encode:!0},t);var n=function(e){return t.encode?encodeURIComponent(e):String(e)};return Object.keys(e).reduce((function(r,o){var i=e[o];return void 0===i?r:null===i?(t.skipNull||r.push([n(o),""].join("=")),r):Array.isArray(i)?(i.map((function(e){r.push("".concat(n(o),"[]=").concat(n(e)))})).join(),r):(r.push([n(o),n(i)].join("=")),r)}),[]).join("&")}};u(l((function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0}))),u(l((function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0})));var T,S=function(){for(var e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e},O=(T=Object.freeze({__proto__:null,default:{}}))&&T.default||T,C=l((function(e,t){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==c&&c.crypto&&(n=c.crypto),!n)try{n=O}catch(e){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},a=i.lib={},s=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||p).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(var s=0;s<o;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new u.init(t,e)}}),l=i.enc={},p=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},d=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},h=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},f=a.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,i=r.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,l=e.min(4*c,i);if(c){for(var p=0;p<c;p+=a)this._doProcessBlock(o,p);n=o.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(a.Hasher=f.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),n)})),w=l((function(e,t){var n;e.exports=(n=C,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)t(r)&&(o<8&&(s[o]=n(e.pow(r,.5))),c[o]=n(e.pow(r,1/3)),o++),r++}();var u=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],p=n[6],d=n[7],h=0;h<64;h++){if(h<16)u[h]=0|e[t+h];else{var f=u[h-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,v=u[h-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;u[h]=m+u[h-7]+g+u[h-16]}var _=r&o^r&i^o&i,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),A=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&p)+c[h]+u[h];d=p,p=l,l=s,s=a+A|0,a=i,i=o,o=r,r=A+(y+_)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+p|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)})),b=l((function(e,t){var n,r,o;e.exports=(r=(n=o=C).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,n){for(var o=[],i=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2|n[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=s<<24-i%4*8,i++}return r.create(o,i)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)}));function P(e){return E.stringify(e,{skipNull:!0})}function D(e){return Object.keys(e).filter((function(e){return i.includes(e)}))}function I(e){var t;return Boolean(null===(t=D(e))||void 0===t?void 0:t.length)}function k(e){var t=function(e){return D(e).reduce((function(t,n){return t[n]=e[n],t}),{})}(e);return btoa(JSON.stringify(t))}function N(e,t){var n,r,o=document.createElement("iframe");for(var i in e&&(o.src=e),o.style.cssText=null!==(n=null==t?void 0:t.cssText)&&void 0!==n?n:"",o.width="100%",o.height="100%",o.style.border="none",o.style.colorScheme="none",null==t?void 0:t.properties)t&&t.properties.hasOwnProperty(i)&&(o[i]=null!==(r=t.properties[i])&&void 0!==r?r:"");return o}function R(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(e){return e&&"object"===r(e)};return e.reduce((function(e,t){return Object.keys(t).forEach((function(r){var o=e[r],i=t[r];Array.isArray(o)&&Array.isArray(i)?e[r]=o.concat.apply(o,i):n(o)&&n(i)?e[r]=R(o,i):e[r]=i})),e}),{})}function x(e,t){return void 0===e?t:"number"!=typeof e?e?1:0:e}function K(e,t){return e&&"object"===r(e)?Object.keys(e).reduce((function(n,r){return t.includes(r)?(n[r]=e[r],n):n}),{}):e}var M,L,U,V=function(e){var t=w(e);return b.stringify(t).replace(/=*$/g,"").replace(/\+/g,"-").replace(/\//g,"_")},H=function(){return S().replace("-","").replace("_","")},G=new(function(){function e(){this.savedStyles=[],this.bodyScrollYValue=0,this.isFreezed=!1}return e.prototype.freezeBodyOverflow=function(){if(!this.isFreezed){this.isFreezed=!0;var e=(n=window.document.documentElement.clientWidth,Math.abs(window.innerWidth-n)),t=parseInt(window.getComputedStyle(window.document.body).paddingRight,10)||0;this.bodyScrollYValue=window.pageYOffset||window.scrollY,this.savedStyles=[],this.savedStyles.push({value:window.document.body.style.paddingRight,property:"padding-right"},{value:window.document.body.style.overflow,property:"overflow"},{value:window.document.body.style.overflowX,property:"overflow-x"},{value:window.document.body.style.overflowY,property:"overflow-y"}),window.document.body.style.setProperty("overflow","hidden"),window.document.body.style.setProperty("padding-right",e+t+"px")}var n},e.prototype.restoreBodyOverflow=function(){this.isFreezed&&(this.savedStyles.forEach((function(e){var t=e.value,n=e.property;t?window.document.body.style.setProperty(n,t):window.document.body.style.removeProperty(n)})),window.scrollTo(0,this.bodyScrollYValue),this.isFreezed=!1)},e}());!function(e){e.OPEN="VKSDKOpen",e.CLOSE="VKSDKClose",e.LOGOUT="VKSDKLogout",e.GET_CAPTCHA="VKSDKGetCaptcha",e.CAPTCHA_SUCCESS="VKSDKGetCaptchaSuccess",e.CAPTCHA_FAILED="VKSDKGetCaptchaFail",e.AUTH_NEEDED="VKSDKAuthNeeded",e.UPDATE_PARAMS="VKSDKUpdateParams",e.REQUEST_SUPERAPP_TOKEN="VKSDKRequestSuperAppToken",e.ERROR="VKSDKError"}(M||(M={})),function(e){e.INIT="VKSDKInit"}(L||(L={})),function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.MISSING_PARAM=2]="MISSING_PARAM",e[e.CONNECTION_LOST=3]="CONNECTION_LOST",e[e.USER_DENIED=4]="USER_DENIED",e[e.INVALID_PARAMS=5]="INVALID_PARAMS",e[e.CUSTOM=6]="CUSTOM",e[e.LOADING_ERROR=7]="LOADING_ERROR",e[e.CONNECT_WINDOW_CLOSED=7]="CONNECT_WINDOW_CLOSED",e[e.CONNECT_WINDOW_NOT_OPENED=8]="CONNECT_WINDOW_NOT_OPENED",e[e.CONNECT_DOMAIN_NOT_ALLOWED=9]="CONNECT_DOMAIN_NOT_ALLOWED",e[e.CONNECT_UNKNOWN_SDK_MESSAGE=10]="CONNECT_UNKNOWN_SDK_MESSAGE",e[e.CONNECT_CLIENT_SDK_ERROR=11]="CONNECT_CLIENT_SDK_ERROR",e[e.VALIDATE_ERROR=12]="VALIDATE_ERROR",e[e.CAPTCHA_ERROR=14]="CAPTCHA_ERROR",e[e.OLD_MISSING_PARAM=100]="OLD_MISSING_PARAM"}(U||(U={}));var B=function(e,t){return'Wrong "'+e+'" param. '+(t||"")},z=function(e){return"The "+e+" parameter must be a string"},W=function(e){return"The "+e+" is required parameter"},F=function(e){return"The "+e+" parameter must be а function"},j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var q,Z,J,Q,X=function(){return(X=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function $(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map((function(e){e(n)})),(e["*"]||[]).slice().map((function(e){e(t,n)}))}}}function ee(e){return"number"==typeof e}function te(e){return"string"==typeof e}function ne(e){return void 0!==e&&""!==e&&null!==e}function re(e){return"function"==typeof e}function oe(e,t,n,r){return{type:e,code:t,message:n,params:r}}function ie(e,t){return{type:U[U.VALIDATE_ERROR],code:U.VALIDATE_ERROR,message:e,params:t}}function ae(e){return e.message?{code:e.code,reason:e.message,data:e.params}:{code:e.code,data:e.params}}!function(e){e.GET_CAPTCHA="VKSDKGetCaptcha",e.APP_CLOSE="VKWebAppClose",e.APP_READY="VKSDKMiniAppReady",e.RESIZE="VKSDKMiniAppResize",e.APP_INIT_CONFIG="VKSDKMiniAppInitConfig",e.OPEN_APP="VKWebAppOpenApp",e.OPEN_PAY_FORM="VKWebAppOpenPayForm",e.ACTION_DONE="VKWebAppActionDone",e.SET_TITLE="VKWebAppSetTitle",e.AUTH_BY_EXCHANGE_TOKEN="VKWebAppAuthByExchangeToken",e.FORCE_LOGOUT="VKWebAppForceLogout"}(q||(q={})),function(e){e.OPEN="open",e.HIDE="hide",e.CLOSE="close",e.SHOW="show",e.MESSAGE="message",e.CREATE_APP="createapp"}(Z||(Z={})),function(e){e.SUPERAPP_TOKEN="VKSDKGeneralSuperAppToken",e.AUTH_NEEDED="VKSDKGeneralAuthNeeded",e.OPEN_APP="VKSDKGeneralOpenApp"}(J||(J={})),function(e){e.SUPERAPP_TOKEN_CHANGE_V2="superAppTokenV2",e.SUPERAPP_TOKEN_CHANGE="superAppToken"}(Q||(Q={}));var se,ce=function(){function e(e,t,n){void 0===e&&(e="Parameter validation error"),this.errorText=e,this.params=t,this.valid=n}return e.prototype.isValid=function(){return Boolean(this.valid)},e.prototype.error=function(e){return this.isValid()?null:e?ae(ie(this.errorText,this.params)):ie(this.errorText,this.params)},e}(),ue=function(){function e(e){this.rules=e}return e.prototype.validate=function(e){for(var t in this.rules)if(this.rules.hasOwnProperty(t))for(var n=0;n<this.rules[t].length;n++){var r=this.rules[t][n];if(!r.rule(e[t]))return new ce(r.errorText,e,!1)}return new ce("",e,!0)},e}(),le=(new ue({params:[{rule:ne,errorText:W("params")}]}),new ue({token:[{rule:te,errorText:z("token")}]})),pe=new ue({event:[{rule:te,errorText:z("event")},{rule:ne,errorText:W("event")}],handler:[{rule:ne,errorText:W("handler")}]}),de=new ue({app:[{rule:function(e){return ee(e)||te(e)},errorText:function(e){return"The "+e+" parameter must be a number or a string"}("app")},{rule:ne,errorText:W("app")}]}),he=new ue({message:[{rule:ne,errorText:W("message")}]}),fe=new ue({handler:[{rule:ne,errorText:W("handler")},{rule:re,errorText:F("handler")}]}),me=new ue({handler:[{rule:ne,errorText:W("handler")},{rule:re,errorText:F("handler")}]}),ve=new ue({handler:[{rule:ne,errorText:W("handler")},{rule:re,errorText:F("handler")}]}),ge=new ue({appId:[{rule:ee,errorText:function(e){return"The "+e+" parameter must be a number"}("appId")}]}),_e={appId:0,superAppToken:"",superAppTokenV2:"",loginDomain:"login.vk.com",oauthDomain:"oauth.vk.com",connectDomain:"id.vk.com",_debug:!1,_localhost:!1},ye={},Ae=function(){function e(){}return e.init=function(e){if(!e.appId)throw new Error("appId required");var t=ge.validate({appId:e.appId});!t.isValid()&&console.error(t.error()),_e.appId=e.appId,_e.superAppToken=e.superAppToken||"",_e.superAppTokenV2=e.superAppTokenV2||"",_e.loginDomain=e.loginDomain||"login.vk.com",_e.oauthDomain=e.oauthDomain||"oauth.vk.com",_e.connectDomain=e.connectDomain||"id.vk.com",_e.appSettings=e.appSettings,_e._debug=!!e._debug,_e._localhost=!!e._localhost},e.get=function(){return _e},e.setSuperAppToken=function(t,n){void 0===n&&(n={});var r=le.validate({token:t});!r.isValid()&&console.error(r.error()),2===n.version?(_e.superAppTokenV2=t,e.events.emit(Q.SUPERAPP_TOKEN_CHANGE_V2,t)):(_e.superAppToken=t,e.events.emit(Q.SUPERAPP_TOKEN_CHANGE,t))},e.onRequestSuperAppToken=function(e){var t=fe.validate({handler:e});!t.isValid()&&console.error(t.error()),ye.requestSuperAppToken=e},e._requestSuperAppToken=function(t,n){var r;void 0===n&&(n={}),ye.requestSuperAppToken&&(r=ye.requestSuperAppToken(t,n)),r&&r.then((function(t){return e.setSuperAppToken(t,n)})).catch(console.error)},e.onAuth=function(e){var t=me.validate({handler:e});!t.isValid()&&console.error(t.error()),ye.auth=e},e._auth=function(t){var n;void 0===t&&(t={}),ye.auth&&(n=ye.auth()),n&&n.then((function(n){e.setSuperAppToken(n,t)})).catch(console.error)},e.onOpenApp=function(e){ye.openApp=e},e._openApp=function(e){ye.openApp&&ye.openApp(e.app)},e.onLogout=function(e){var t=ve.validate({handler:e});!t.isValid()&&console.error(t.error()),ye.logout=e},e._logout=function(){ye.logout&&ye.logout()},e.fetchDomain=function(){return Boolean(se)||(se=new Promise((function(e){fetch("https://vk.ru/domain.txt").then((function(e){return e.text()})).then((function(e){return e.trim()})).then((function(e){_e.loginDomain=_e.loginDomain.replace("vk.com",e),_e.oauthDomain=_e.oauthDomain.replace("vk.com",e),_e.connectDomain=_e.connectDomain.replace("vk.com",e)})).then(e).catch((function(t){e(),console.warn(t)}))}))),se},e.events=$(),e}(),Ee=new ue({iframe:[{rule:ne,errorText:W("iframe")}],origin:[{rule:te,errorText:z("origin")},{rule:ne,errorText:W("origin")}]}),Te=new ue({event:[{rule:ne,errorText:W("event")}]}),Se=new ue({handler:[{rule:ne,errorText:W("handler")},{rule:re,errorText:F("handler")}]}),Oe=new ue({handler:[{rule:ne,errorText:W("handler")}],params:[{rule:ne,errorText:W("params")}]}),Ce=function(e){var t=this;this.handler=function(){return{}},this.destroy=function(){delete t.config,window.removeEventListener("message",t.handleMessage)},this.onMessage=function(e){var n=Se.validate({handler:e});!n.isValid()&&console.error(n.error()),t.handler=e},this.sendMessage=function(e){var n,r=Oe.validate(e);!r.isValid()&&console.error(r.error()),null===(n=t.config.iframe.contentWindow)||void 0===n||n.postMessage(X({type:"vk-sak-sdk"},e),t.config.origin)},this.handleMessage=function(e){var n=Te.validate({event:e});!n.isValid()&&console.error(n.error()),t.config.origin&&e.origin===t.config.origin&&e.source===t.config.iframe.contentWindow&&e.data&&"vk-sak-sdk"===e.data.type&&t.handler(e.data)};var n=Ee.validate(e);!n.isValid()&&console.error(n.error()),this.config=e,window.addEventListener("message",this.handleMessage)},we=function(){function e(){var e=this;this.resolve=function(t){if(Boolean(e.promise))return e.finished=!0,e.active=!1,e.resolveHandler(t)},this.reject=function(t){if(Boolean(e.promise))return e.finished=!0,e.active=!1,e.rejectHandler(t)}}return e.prototype.start=function(){var e=this;this.active=!0,this.finished=!1,this.promise=new Promise((function(t,n){e.resolveHandler=t,e.rejectHandler=n}))},e.prototype.get=function(){return this.promise},e}(),be=["extend_token","login_with_user","login_silent_user","__sferum_invite_link","registration_with_phone","registration_with_email","validate_phone","bind_ok_account","no_password_flow","confirm_service_action","login_with_eljour","login_with_edu_profile","login_with_multi_user","auth_validation_phone","qr_auth","multi_account_flow"];function Pe(e){return e&&be.includes(e.name)?btoa(JSON.stringify(e)):""}function De(e){return e?btoa(JSON.stringify(e)):""}function Ie(e,t){return void 0===t&&(t="auth"),Ae.fetchDomain().then((function(){var n=Ae.get(),r=n.appId,o=n.connectDomain,i=n.appSettings,a=n._debug,s=n._localhost,c=X({app_id:r,response_type:"silent_token",v:"1.60.6",debug:a?1:null,localhost:s?1:null},e);i&&I(i)&&(c.app_settings=k(i));var u=P(c);return Promise.resolve("https://"+o+"/"+t+"?"+u)}))}var ke,Ne=[0,1,3,4,6,15,16,82];!function(e){e.Default="default",e.NamePhone="name_phone",e.PhoneName="phone_name"}(ke||(ke={}));var Re,xe=[ke.Default,ke.NamePhone,ke.PhoneName];!function(e){e.Primary="primary",e.Flat="flat"}(Re||(Re={}));var Ke,Me=[Re.Primary,Re.Flat];!function(e){e.CAPTCHA_SUCCESS="VKSDKAuthCaptchaSuccess",e.CAPTCHA_FAIL="VKSDKAuthCaptchaFail"}(Ke||(Ke={}));var Le,Ue=function(e,t,n){var r=this;this.events=$(),this.showReadyPromiseTask=new we,this.init=function(){Ae.fetchDomain().then((function(){Ie(X(X({origin:location.protocol+"//"+location.host,uuid:r.uuid},r.captchaData),{scheme:r.scheme||null,is_refresh_enabled:Number(r.captchaData.is_refresh_enabled)}),"auth_captcha").then(r.handleCaptcha)}))},this.createFrame=function(){return r.iframe=N("",{cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      min-height: 100vh;\n      border: none;\n      z-index: 99999;\n      color-scheme: none;\n     "}),r},this.handleError=function(e){var t=ae(oe(U[U.CUSTOM],U.CUSTOM,"",e));r.events.emit(M.ERROR,t)},this.onMessage=function(e){switch(e.handler){case M.ERROR:r.handleError(e.params);break;case Ke.CAPTCHA_SUCCESS:r.showReadyPromiseTask.resolve(e.params),r.destroy();break;default:r.showReadyPromiseTask.reject(),r.destroy()}},this.handleCaptcha=function(e){r.iframe.src=e,document.body.appendChild(r.iframe),r.bridge=new Ce({iframe:r.iframe,origin:"https://"+Ae.get().connectDomain}),r.bridge.onMessage(r.onMessage)},this.destroy=function(){r.iframe&&document.body.removeChild(r.iframe),r.bridge&&r.bridge.destroy()},this.show=function(){return r.iframe.style.display="block",new Promise((function(e){r.showReadyPromiseTask.start(),r.showReadyPromiseTask.get().then(e)}))},this.uuid=e,this.captchaData=t,this.scheme=n,this.createFrame().init()},Ve=function(){function e(t){var n=this;this.readyPromiseResolve=null,this.readyPromise=null,this.child=null,this.initialTitle=window.document.title,this.open=function(e,t){return Ae.fetchDomain().then((function(){return n.loading?(n.getMiniAppUrl(e,t).then((function(e){n.iframe.src=e})),n.loading=new Promise((function(e){n.iframe.onload=function(){n.iframe.onload=null,e()}})),n.readyPromise=new Promise((function(e){return n.readyPromiseResolve=e})),n.eventOpenSettings(),n.readyPromise):n.preload(e,t).catch(console.error)}))},this.eventOpenSettings=function(){n.iframe.style.display="block",n.params.stackMode||G.freezeBodyOverflow(),n.loading.then(n.handleResize).catch(console.error),n.events.emit(Z.OPEN)},this.hide=function(){n.iframe.style.display="none",n.params.stackMode||G.restoreBodyOverflow(),n.events.emit(Z.HIDE)},this.close=function(e){window.document.title!==n.initialTitle&&(window.document.title=n.initialTitle),n.params.stackMode||G.restoreBodyOverflow(),n.iframe&&n.iframe.remove(),n.bridge&&n.bridge.destroy(),delete n.iframe,delete n.bridge,Ae.events.off(Q.SUPERAPP_TOKEN_CHANGE,n.onSuperAppToken),window.removeEventListener("resize",n.handleResize),n.events.emit(Z.CLOSE,e)},this.show=function(){if(!n.loading)throw new Error('App is not loaded, use "open" or "preload" methods');n.iframe.style.display="block",n.params.stackMode||G.freezeBodyOverflow(),n.events.emit(Z.SHOW)},this.preload=function(e,t){return Ae.fetchDomain().then((function(){var r=document.createElement("iframe"),o=window.innerHeight,i=isFinite(n.params.zIndex)?n.params.zIndex:999999;return n.getMiniAppUrl(e,t).then((function(e){r.src=e})),r.setAttribute("allow","geolocation"),r.style.cssText="\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+o+"px;\n      min-height: "+o+"px;\n      border: none;\n      z-index: "+i+";\n      color-scheme: none;\n    ",n.iframe=r,document.body.appendChild(n.iframe),n.bridge=new Ce({iframe:n.iframe,origin:"https://"+Ae.get().connectDomain}),n.loading=new Promise((function(e){r.onload=function(){r.onload=null,e()}})),n.readyPromise=new Promise((function(e){return n.readyPromiseResolve=e})),n.bridge.onMessage(n.handleMessage),Ae.events.on(Q.SUPERAPP_TOKEN_CHANGE,n.onSuperAppToken),window.addEventListener("resize",n.handleResize),n.eventOpenSettings(),n.loading}))},this.sendMessage=function(e){var t=he.validate({message:e});!t.isValid()&&console.error(t.error()),n.bridge.sendMessage(e)},this.onSuperAppToken=function(e){n.bridge.sendMessage({handler:J.SUPERAPP_TOKEN,params:{result:e}})},this.handleError=function(e){var t=ae(oe(U[U.CUSTOM],U.CUSTOM,"",e));n.events.emit(M.ERROR,t)},this.handleMessage=function(e){switch(e.handler){case M.GET_CAPTCHA:var t=e.params.uuid,r=new Ue(t,{captcha_sid:e.params.captcha_sid,captcha_img:e.params.captcha_img,is_refresh_enabled:e.params.is_refresh_enabled});r.show().then((function(e){n.bridge.sendMessage({handler:M.CAPTCHA_SUCCESS,params:X({uuid:t},e)})})).catch((function(){n.bridge.sendMessage({handler:M.CAPTCHA_FAILED,params:{uuid:t}}),r.destroy()}));break;case q.APP_CLOSE:n.hide();break;case M.ERROR:n.handleError(e.params);break;case q.APP_READY:n.resolveReadyPromise(),n.handleUpdateConfig();break;case q.OPEN_APP:n.openMiniapp(e.params);break;case q.OPEN_PAY_FORM:n.openPayForm(e.params);break;case q.SET_TITLE:n.setTitle(e.params);break;case q.AUTH_BY_EXCHANGE_TOKEN:n.onAuthByExchangeToken();break;case q.FORCE_LOGOUT:n.onForceLogout(e.params);break;case J.SUPERAPP_TOKEN:Ae._requestSuperAppToken(e.params);break;case J.AUTH_NEEDED:Ae._auth();break;default:n.events.emit(Z.MESSAGE,e)}},this.handleResize=function(){if(n.iframe){var e=innerWidth,t=innerHeight;n.iframe.style.height=t+"px",n.iframe.style.minHeight=t+"px",n.bridge.sendMessage({handler:q.RESIZE,params:{viewport_width:e,viewport_height:t}})}},this.handleUpdateConfig=function(){n.bridge.sendMessage({handler:q.APP_INIT_CONFIG,params:{fullMode:n.params.fullMode,hideMenu:n.params.hideMenu,scheme:n.params.scheme}})},this.update=function(e){e&&(n.params=R(n.params,e||{}),n.sendUpdateParamsMessage())},this.getMiniAppUrl=function(e,t){return Ae.fetchDomain().then((function(){var r=Ae.get(),o=r.connectDomain,i=r.appId,a=r.superAppToken,s=r._debug,c=r._localhost;return"https://"+o+"/mini_app?"+P({app:n.params.app,host_app_id:i,superapp_token:a,app_query:e?JSON.stringify(e):"",app_hash:t||"",debug:s?1:null,localhost:c?1:null})}))},this.resolveReadyPromise=function(){n.readyPromise&&n.readyPromiseResolve&&(n.readyPromiseResolve(),n.readyPromise=null,n.readyPromiseResolve=null)},this.openMiniapp=function(t){n.child=new e({app:t.app_id,stackMode:n.params.stackMode}),n.events.emit(Z.CREATE_APP,{app:n.child,location:t.location})},this.openPayForm=function(t){var r=X({},t.params);r.data&&(r.data=JSON.stringify(r.data));var o=X(X({},r),{app_id:t.app_id,action:t.action}),i=new e({app:6217559,stackMode:n.params.stackMode});i.open(o).then((function(){return n.hide()})).catch(console.error),i.events.on(Z.MESSAGE,(function(e){n.handleVKPayFormMessage(e),i.close(),n.show()})),i.events.on(Z.HIDE,(function(){i.close(),n.close()}))},this.setTitle=function(e){window.document.title=e.title},this.onAuthByExchangeToken=function(){n.close({closedByExchangeToken:!0})},this.onForceLogout=function(e){n.close({closedByForceLogout:!0,additionalParams:e})},this.handleVKPayFormMessage=function(e){e.handler===q.ACTION_DONE&&n.sendMessage(e),e.handler===M.ERROR&&n.handleError(e.params)};var r=de.validate(t);!r.isValid()&&console.error(r.error()),this.params=X(X({},t),{app:"number"==typeof t.app?"app"+t.app:t.app,scheme:"string"==typeof t.scheme?t.scheme:"bright_light"}),this.events=$()}return e.prototype.on=function(e,t){var n=pe.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.on(e,t)},e.prototype.off=function(e,t){var n=pe.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.off(e,t)},e.prototype.sendUpdateParamsMessage=function(){this.bridge&&this.bridge.sendMessage({params:this.params,handler:M.UPDATE_PARAMS})},e}();!function(){function e(){this.stack=[]}e.prototype.removeMiniApp=function(e){var t=e.app,n=this.stack.lastIndexOf(t);if(n>-1&&n===this.stack.length-1)if(this.stack.splice(n,1),this.stack.length){this.stack[this.stack.length-1].show();var r=this.stack[this.stack.length-2];setTimeout((function(){return null==r?void 0:r.hide()}),0)}else G.restoreBodyOverflow()},e.prototype.makeHandleMiniAppClose=function(e){var t=this,n=e.app;return function(){t.removeMiniApp({app:n})}},e.prototype.makeHandleMiniAppHide=function(e){var t=this,n=e.app;return function(){var e=t.stack.lastIndexOf(n);e>-1&&e===t.stack.length-1&&setTimeout((function(){return n.close()}),0)}},e.prototype.handleMiniAppCreate=function(e){var t=e.app,n=e.query,r=e.hash;this.stack.push(t),t.open(n,r).catch(console.error),t.events.on(Z.CREATE_APP,this.handleMiniAppCreate.bind(this)),t.events.on(Z.HIDE,this.makeHandleMiniAppHide({app:t})),t.events.on(Z.CLOSE,this.makeHandleMiniAppClose({app:t})),G.freezeBodyOverflow();var o=this.stack[this.stack.length-2];return setTimeout((function(){null==o||o.hide()}),0),t},Object.defineProperty(e.prototype,"length",{get:function(){return this.stack.length},enumerable:!1,configurable:!0}),e.prototype.open=function(e){var t=de.validate(e);!t.isValid()&&console.error(t.error());var n=e.app,r=e.query,o=e.hash,i=new Ve({app:n,stackMode:!0});return this.handleMiniAppCreate({app:i,query:r,hash:o}),i},e.prototype.close=function(){var e=this.stack;this.stack.splice(0),e.reverse().forEach((function(e){return e.close()})),G.restoreBodyOverflow()}}();!function(e){e.STATIC_MAP="VKSDKRequestToGeoservice:staticmap/png/",e.SEARCH="VKSDKRequestToGeoservice:search",e.OVERALL="VKSDKRequestToGeoservice:overall",e.DIRECTIONS="VKSDKRequestToGeoservice:directions",e.ISO="VKSDKRequestToGeoservice:iso"}(Le||(Le={}));var He,Ge,Be,ze,We,Fe,je;!function(){function e(e){var t=this;this.apiKey=e.apiKey,this.requestMap={};var n=document.createElement("iframe");this.iframe=n,Ae.fetchDomain().then((function(){var e=Ae.get().appId;t.getGeoserviceProxyUrl({app_id:e}).then((function(e){n.src=e})),n.style.cssText="\n      display: none;\n    ",document.body.appendChild(t.iframe),t.bridge=new Ce({iframe:t.iframe,origin:"https://"+Ae.get().connectDomain}),t.bridge.onMessage((function(e){var n=e.params,r=n.requestID,o=n.response;t.requestMap[r].resolve(o),delete t.requestMap[r]}))}))}e.prototype.setApiKey=function(e){this.apiKey=e},e.prototype.getGeoserviceProxyUrl=function(e){return Ae.fetchDomain().then((function(){var t=Ae.get(),n=t.connectDomain,r=t._debug,o=t._localhost;return"https://"+n+"/geoservice?"+P(X(X({},e||{}),{origin:location.protocol+"//"+location.host,debug:r?1:null,localhost:o?1:null}))}))},e.prototype.prepareAnswer=function(e,t,n){var r=this,o=S();return this.bridge.sendMessage({handler:"VKSDKRequestToGeoservice:"+e,params:X(X({},t),{api_key:this.apiKey,wrapRequestInJSON:n,requestID:o})}),new Promise((function(e,t){r.requestMap[o]={resolve:e,reject:t}}))},e.prototype.getStaticMap=function(e){return this.prepareAnswer("staticmap/png/",e)},e.prototype.encodeCoords=function(e){return this.prepareAnswer("search",e)},e.prototype.decodeCoords=function(e){return this.prepareAnswer("overall",e)},e.prototype.getDirections=function(e){return this.prepareAnswer("directions",e,!0)},e.prototype.getISO=function(e){return this.prepareAnswer("iso",e,!0)}}();!function(e){e.SHOW_DATA_POLICY="VKSDKOneTapAuthConnectDataPolicy",e.HIDE_DATA_POLICY="VKSDKOneTapAuthDataPolicyClose",e.DATA_POLICY_RESULT="VKSDKOneTapAuthDataPolicyResult",e.SHOW_CAPTCHA="VKSDKOneTapAuthDataPolicyShowCaptcha"}(He||(He={})),function(e){e.SHOW_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsShow",e.HIDE_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsHide",e.ACCEPT_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsAccept",e.DECLINE_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsDecline",e.POLICY_AGREEMENTS_ERROR="VKSDKOneTapAuthPolicyAgreementsError",e.SHOW_DATA_POLICY="VKSDKOneTapAuthPolicyAgreementsShowDataPolicy",e.GET_CAPTCHA="VKSDKGetCaptcha",e.CAPTCHA_SUCCESS="VKSDKGetCaptchaSuccess",e.CAPTCHA_FAIL="VKSDKGetCaptchaFail"}(Ge||(Ge={})),function(e){e.PHONE_VALIDATION_NEEDED="VKSDKOneTapAuthPhoneValidationNeeded",e.FULL_AUTH_NEEDED="VKSDKOneTapAuthFullAuthNeeded",e.AUTH_DATA_LOADED="VKSDKOneTapAuthDataLoaded",e.NOT_AUTHORIZED="VKSDKOneTapAuthNotAuthorized",e.LOGIN_SUCCESS="VKSDKOneTapAuthLoginSuccess",e.LOGIN_FAILED="VKSDKOneTapAuthLoginFailed",e.RESIZE_FRAME="VKSDKOneTapResizeFrame",e.SHOW_CAPTCHA="VKSDKOneTapShowCaptcha",e.VALIDATE_CAPTCHA="VKSDKOneTapValidateCaptcha",e.UPDATE_PARAMS="VKSDKUpdateParams",e.AUTHORIZE_NEEDED="VKSDKButtonOneTapAuthAuthorizeNeeded"}(Be||(Be={})),function(e){e.CLOSE_AUTH="VKSDKOneTapAuthClose",e.ADAPTIVITY_CHANGE="VKSDKFloatingOneTapAdaptivityChange",e.ADAPTIVITY_CHANGED="VKSDKFloatingOneTapAdaptivityChanged",e.UPDATE_PARAMS="VKSDKUpdateParams"}(ze||(ze={})),function(e){e.SHOW_LOGIN="VKSDKButtonOneTapAuthShowLogin",e.SHOW_LOGIN_OPTIONS="VKSDKButtonOneTapAuthShowLoginOptions",e.SHOW_AGREEMENTS_DIALOG="VKSDKButtonOneTapAuthShowAgreementsDialog",e.START_AUTHORIZE="VKSDKButtonOneTapAuthStartAuthorize",e.UPDATE_PARAMS="VKSDKUpdateParams"}(We||(We={})),function(e){e.WRONG_TOKEN="VKSDKBindAccountErrorWrongToken",e.ALREADY_BIND="VKSDKBindAccountErrorAlreadyBind"}(Fe||(Fe={})),function(e){e.VK_CONNECT_RESPONSE="vk_connect_response",e.OAUTH_CALLBACK="oauth_callback",e.SKIP_CALLBACK="skip_callback",e.BIND_OK_ACCOUNT="bind_ok_account"}(je||(je={}));var Ye,qe=new ue({url:[{rule:te,errorText:z("url")},{rule:ne,errorText:W("url")}]}),Ze=new ue({uuid:[{rule:te,errorText:z("uuid")},{rule:ne,errorText:W("uuid")}]}),Je=(new ue({params:[{rule:ne,errorText:W("params")}]}),new ue({callback:[{rule:ne,errorText:W("callback")}]})),Qe=function(){function e(){}return e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),Xe=new ue({params:[{rule:ne,errorText:W("params")}]}),$e=function(){function e(){var e=this;this.config={},this.params={},this.loadingTask=new we,this.initTask=new we,this.cssText="",this.handleError=function(t){var n=ae(oe(U[U.CUSTOM],U.CUSTOM,"",t));e.events.emit(M.ERROR,n)},this.events=$(),this.handleBridgeMessage=this.handleBridgeMessage.bind(this),this.handleChangeSuperAppToken=this.handleChangeSuperAppToken.bind(this),this.close=this.close.bind(this),this.handleLogout=this.handleLogout.bind(this)}return e.prototype.preload=function(e){var t=this;return Ae.fetchDomain().then((function(){return t.validateParams(e).then((function(){return t.updateParams(e),t.createIframe().then((function(){return t.initTask.start(),t.loadingTask.start(),t.timeoutTimer=setTimeout((function(){if(!t.initTask.finished){var e=ae(oe(U[U.LOADING_ERROR],U.LOADING_ERROR,"Loading timeout"));t.initTask.reject(e)}}),5e3),t.iframe.onload=function(){t.iframe.onload=null,t.loadingTask.resolve()},t.bridge=new Ce({iframe:t.iframe,origin:"https://"+Ae.get().connectDomain}),t.bridge.onMessage(t.handleBridgeMessage),Ae.events.on(Q.SUPERAPP_TOKEN_CHANGE_V2,t.handleChangeSuperAppToken),Ae.events.on(M.LOGOUT,t.close),t.getIframeContainer().appendChild(t.iframe),t.loadingTask.get()}))}))}))},e.prototype.open=function(e){var t=this;return this.validateParams(e).then((function(){return t.initTask.finished?(t.updateParams(e),Promise.resolve()):t.initTask.active||t.initTask.finished?(t.updateParams(e),t.initTask.get()):t.preload(e).then((function(){return t.initTask.get()}))}))},e.prototype.update=function(e,t){e&&this.updateParams(e),t&&this.updateConfig(t)},e.prototype.close=function(){this.iframe&&(this.iframe.onload=null,this.iframe.remove()),this.bridge&&this.bridge.destroy(),Ae.events.off(Q.SUPERAPP_TOKEN_CHANGE_V2,this.handleChangeSuperAppToken),Ae.events.off(M.LOGOUT,this.close),delete this.iframe,delete this.bridge,this.loadingTask=new we,this.initTask=new we,this.events.emit(M.CLOSE)},e.prototype.sendMessage=function(e){var t=he.validate({message:e});!t.isValid()&&console.error(t.error()),this.bridge.sendMessage(e)},e.prototype.on=function(e,t){var n=pe.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.on(e,t)},e.prototype.off=function(e,t){var n=pe.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.off(e,t)},e.prototype.handleInit=function(){this.initTask.finished||(clearTimeout(this.timeoutTimer),this.initTask.resolve()),this.sendUpdateParamsMessage(),this.iframe.style.display="block"},e.prototype.handleRequestAuth=function(){Ae._auth({version:2})},e.prototype.handleRequestSuperAppToken=function(e){Ae._requestSuperAppToken(e,{version:2})},e.prototype.handleChangeSuperAppToken=function(e){this.bridge.sendMessage({handler:M.REQUEST_SUPERAPP_TOKEN+"Success",params:{result:e}})},e.prototype.handleBridgeMessage=function(e){switch(Qe.log(e),e.handler){case L.INIT:this.handleInit();break;case M.REQUEST_SUPERAPP_TOKEN:this.handleRequestSuperAppToken(e.params);break;case M.AUTH_NEEDED:this.handleRequestAuth();break;case M.CLOSE:this.close();break;case M.ERROR:this.handleError(e.params);break;default:return}},e.prototype.handleLogout=function(){Ae._logout()},e.prototype.handleAfterUpdateParams=function(){this.sendUpdateParamsMessage()},e.prototype.handleAfterUpdateConfig=function(){},e.prototype.handleAfterCreateIframe=function(){},e.prototype.validateParams=function(e){var t=Xe.validate({params:e});return!t.isValid()&&console.error(t.error()),Promise.resolve(e)},e.prototype.createIframe=function(){var e=this;return this.getIframeUrl().then((function(t){return e.iframe=N(t,{cssText:e.cssText}),e.handleAfterCreateIframe(),Promise.resolve()}))},e.prototype.getIframeUrl=function(){return new Promise((function(e){return e("")}))},e.prototype.getIframeContainer=function(){return window.document.body},e.prototype.getIframeUrlParams=function(){var e=this;return Ae.fetchDomain().then((function(){var t=Ae.get(),n=t.superAppTokenV2,r=t.appId,o=t._debug,i=t._localhost;return Promise.resolve(P(X(X({},e.params),{host_app_id:r,superapp_token:n,origin:location.protocol+"//"+location.host,debug:o?1:null,localhost:i?1:null})))}))},e.prototype.updateConfig=function(e){this.config=R(this.config,e),this.handleAfterUpdateConfig()},e.prototype.updateParams=function(e){this.params=R(this.params,e||{}),this.handleAfterUpdateParams()},e.prototype.sendUpdateParamsMessage=function(){this.bridge&&this.initTask.finished&&this.bridge.sendMessage({params:this.params,handler:M.UPDATE_PARAMS})},e}();!function(e){e.CLOSE="VKSDKAuthorizeClose",e.FAILED="VKSDKAuthorizeFailed",e.SUCCESS="VKSDKAuthorizeSuccess"}(Ye||(Ye={}));var et,tt,nt=new ue({scope:[{rule:ne,errorText:W("scope")},{rule:te,errorText:z("scope")}]}),rt=function(e){function t(t){var n=e.call(this)||this;n.cssText="\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9999;\n    border: none;\n    display: none;\n    color-scheme: none;\n  ";var r=nt.validate({scope:t.scope});return!r.isValid()&&console.error(r.error()),n.updateConfig(t),n}return Y(t,e),t.prototype.handleBridgeMessage=function(t){switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case Ye.SUCCESS:t.params.code_verifier=this.codeVerifier,this.events.emit(Ye.SUCCESS,t);break;case Ye.FAILED:this.events.emit(Ye.FAILED,t);break;case Ye.CLOSE:this.close();break;default:return}},t.prototype.getIframeUrlParams=function(){var e=this;return Ae.fetchDomain().then((function(){var t,n,r,o=Ae.get(),i=o.appId,a=o._debug,s=o._localhost,c=S();return Promise.resolve(P(X(X({},e.params),{debug:a?1:null,localhost:s?1:null,client_id:i,code_challenge:e.codeChallenge,code_challenge_method:"s256",response_type:"code",state:c,origin:location.protocol+"//"+location.host,redirect_uri:null!==(t=e.config.redirect_uri)&&void 0!==t?t:location.protocol+"//"+location.host,device_id:null!==(n=e.config.device_id)&&void 0!==n?n:"",scope:null!==(r=e.config.scope)&&void 0!==r?r:""})))}))},t.prototype.open=function(t){return void 0===t&&(t={}),this.codeVerifier=H(),this.codeChallenge=V(this.codeVerifier),e.prototype.open.call(this,t)},t.prototype.getIframeUrl=function(){var e=this;return Ae.fetchDomain().then((function(){return e.getIframeUrlParams().then((function(e){var t=Ae.get().connectDomain;return Promise.resolve("https://"+t+"/authorize?"+e)}))}))},t.prototype.handleAfterUpdateConfig=function(){this.updateZIndex()},t.prototype.handleAfterCreateIframe=function(){this.updateZIndex()},t.prototype.updateZIndex=function(){if(this.iframe){var e=this.config.zIndex;this.iframe.style.zIndex=""+e}},t}($e),ot=function(){function e(){}var t;return e.on=function(e,t){var n=pe.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.on(e,t)},e.off=function(e,t){var n=pe.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.off(e,t)},t=e,e.flags=null,e.events=$(),e.handleError=function(e){var n=ae(oe(U[U.CUSTOM],U.CUSTOM,"",e));t.events.emit(M.ERROR,n)},e.silentAuth=function(){return Ae.fetchDomain().then((function(){var e=Ae.get(),t=e.loginDomain,n=e.appId,r=new we,o=S(),i="https://"+t+"/?act=connect&app_id="+n+"&response_type=silent_token&uuid="+o+"&v=1.60.6",a=new XMLHttpRequest;return a.open("GET",i,!0),a.responseType="json",a.withCredentials=!0,r.start(),a.onload=function(){var e,t=a.response,n=a.status>=200&&a.status<300;if(t&&(null===(e=t.error)||void 0===e?void 0:e.error_code)===U.CAPTCHA_ERROR){var s=t.error,c=s.captcha_sid,u=s.captcha_img,l=s.is_refresh_enabled;new Ue(o,{captcha_sid:c,captcha_img:u,is_refresh_enabled:l}).show().then((function(e){var t=i+"&captcha_key="+e.captcha_key+"&captcha_sid="+e.captcha_sid;a.open("GET",t,!0),a.send()}))}else t&&n?r.resolve({provider:"vk",payload:a.response}):r.reject()},a.onerror=function(){r.reject()},a.send(),r.get()}))},e.oneTapAuth=function(t,n){if(console.warn("Connect.oneTapAuth method is deprecated. Use Connect.floatingOneTapAuth and Connect.buttonOneTapAuth methods."),!["floating","button"].includes(t))return null;switch(t){case"button":return e.buttonOneTapAuth(n);case"floating":return e.floatingOneTapAuth(n);default:return null}},e.floatingOneTapAuth=function(n){var r=Je.validate({callback:n.callback});!r.isValid()&&console.error(r.error());var o=function(){var e,t=window.innerWidth,n=t<=768;return{destroy:function(){return window.removeEventListener("resize",e)},isAdaptive:function(){return n},observe:function(r){e=function(){var e=window.innerWidth;t>768&&e<=768?r(n=!0):t<=768&&e>768&&r(n=!1),t=e},window.addEventListener("resize",e)}}}(),i=function(e,t){var n,r,o,i={},a=e?"314px":"334px",s=e?"\n      display: none;\n      position: fixed;\n      bottom: 0;\n      right: 50%;\n      transform: translate(50%, 0);\n      max-width: 468px;\n      width: 100%;\n      height: "+a+";\n      color-scheme: none;\n    ":"\n        display: none;\n        position: fixed;\n        top: 0;\n        right: 0;\n        max-width: 400px;\n        width: 100%;\n        height: "+a+";\n        color-scheme: none;\n      ";return(null===(n=null==t?void 0:t.styles)||void 0===n?void 0:n.zIndex)&&isFinite(null===(r=null==t?void 0:t.styles)||void 0===r?void 0:r.zIndex)&&(s+="z-index: "+(null===(o=null==t?void 0:t.styles)||void 0===o?void 0:o.zIndex)+";"),t&&(i.skip_success=x(t.skipSuccess,0),void 0!==t.scheme&&["bright_light","space_gray"].includes(t.scheme)&&(i.scheme=t.scheme)),{pageUrl:"floating_one_tap_auth",pageUrlParams:X({adaptive:e?1:0},i),frameStyles:s,scheme:null==t?void 0:t.scheme}}(o.isAdaptive(),n.options),a=H(),s=V(a);if(!i)throw new Error("options were not set");var c,u,l,p=S(),d=X({origin:location.protocol+"//"+location.host,uuid:p},i.pageUrlParams),h=i.pageUrl,f=new we,m=function(){u&&u.sendMessage({handler:Be.RESIZE_FRAME,params:{uuid:p}})},v=function(){c&&(c.remove(),c=null),window.removeEventListener("resize",m),o&&o.destroy(),u&&u.destroy()};l=new Promise((function(e){f.start(),f.get().then((function(t){e(t)}))}));var g=function(r){var o=r.params.uuid===p;if(r.params.code_verifier=a,o)switch(r.handler){case M.ERROR:t.handleError(r.params);break;case Be.NOT_AUTHORIZED:n.callback({type:r.handler,payload:{uuid:p,error:"not_authorized"}}),v(),f.resolve(r.handler);break;case Be.RESIZE_FRAME:c.style.height=r.params.height+"px";break;case ze.CLOSE_AUTH:n.callback({type:r.handler,payload:{uuid:p}}),v();break;case ze.ADAPTIVITY_CHANGED:c.style.display="block";break;case Be.AUTH_DATA_LOADED:c.style.display="block",f.resolve(r.handler);default:e.handleOneTapEvents(r,u,n)}};return c=N("",{cssText:null==i?void 0:i.frameStyles}),document.body.appendChild(c),Ae.fetchDomain().then((function(){return Ie(X(X({},d),{code_challenge:s,code_challenge_method:"s256"}),h).then((function(e){c.src=e,(u=new Ce({iframe:c,origin:"https://"+Ae.get().connectDomain})).onMessage(g),o.observe((function(e){u.sendMessage({handler:ze.ADAPTIVITY_CHANGE,params:{uuid:p,is_adaptive:e}}),e?(c.style.maxWidth="468px",c.style.top="auto",c.style.bottom="0",c.style.right="50%",c.style.transform="translate(50%, 0)"):(c.style.maxWidth="400px",c.style.top="0",c.style.bottom="auto",c.style.right="0",c.style.transform="none"),c.style.display="none"})),window.addEventListener("resize",m)}))})),{getFrame:function(){return c},destroy:v,authReadyPromise:l,update:function(e){i=R(i||{},e),u&&i&&u.sendMessage({handler:ze.UPDATE_PARAMS,params:i})}}},e.buttonOneTapAuth=function(t){var n=Je.validate({callback:t.callback});!n.isValid()&&console.error(n.error());var r=function(e){var t,n,r,o,i,a,s={},c=44,u=56;return e&&(s.display=e.displayMode&&xe.includes(e.displayMode)?e.displayMode:ke.Default,s.button_skin=e.buttonSkin&&Me.includes(e.buttonSkin)?e.buttonSkin:Re.Primary,s.show_agreements=x(e.showAgreements,0),s.show_alternative_login=x(e.showAlternativeLogin,0),void 0!==e.scheme&&["bright_light","space_gray"].includes(e.scheme)&&(s.scheme=e.scheme),void 0!==(null===(t=e.buttonStyles)||void 0===t?void 0:t.height)&&(c=Number(null===(n=e.buttonStyles)||void 0===n?void 0:n.height),u=Number(null===(r=e.buttonStyles)||void 0===r?void 0:r.height)+12,s.style_height=null===(o=e.buttonStyles)||void 0===o?void 0:o.height),void 0!==(null===(i=e.buttonStyles)||void 0===i?void 0:i.borderRadius)&&(s.style_border_radius=null===(a=e.buttonStyles)||void 0===a?void 0:a.borderRadius),void 0!==e.langId&&(s.lang_id=Ne.includes(e.langId)?e.langId:0),c+=s.show_alternative_login?u:0,c+=s.show_agreements?80:0),{pageUrl:"button_one_tap_auth",pageUrlParams:s,frameStyles:"\n        height: "+c+"px;\n      ",scheme:null==e?void 0:e.scheme}}(t.options),o=H(),i=V(o);if(!r)throw new Error("options were not set");var a,s,c,u=S(),l=X({origin:location.protocol+"//"+location.host,uuid:u},r.pageUrlParams),p=r.pageUrl,d=new we;c=new Promise((function(e){d.start(),d.get().then((function(t){e(t)}))}));var h=function(){s&&s.sendMessage({handler:Be.RESIZE_FRAME,params:{uuid:u}})},f=function(n){var i=n.params.uuid===u;if(n.params.code_verifier=o,i)switch(n.handler){case Be.RESIZE_FRAME:a.style.height=n.params.height+"px";break;case Be.NOT_AUTHORIZED:d.resolve(n.handler);break;case We.SHOW_LOGIN:case We.SHOW_LOGIN_OPTIONS:t.callback({type:n.handler,payload:{uuid:u}});break;case We.SHOW_AGREEMENTS_DIALOG:e.userPolicyAgreements(u,null==r?void 0:r.scheme).show().then((function(e){e&&e.accepted&&s.sendMessage({handler:We.START_AUTHORIZE,params:{uuid:u}})})).catch((function(){s.sendMessage({handler:Ge.DECLINE_POLICY_AGREEMENTS,params:{uuid:u}})}));break;case Be.AUTH_DATA_LOADED:d.resolve(n.handler);default:e.handleOneTapEvents(n,s,t)}};a=N("",{cssText:null==r?void 0:r.frameStyles});var m=t.container;return m&&m.appendChild(a),Ae.fetchDomain().then((function(){return Ie(X(X({},l),{code_challenge:i,code_challenge_method:"s256"}),p).then((function(e){a.src=e,(s=new Ce({iframe:a,origin:"https://"+Ae.get().connectDomain})).onMessage(f),window.addEventListener("resize",h)}))})).catch(console.error),{getFrame:function(){return a},destroy:function(){a&&(a.remove(),a=null),window.removeEventListener("resize",h),s&&s.destroy()},authReadyPromise:c,update:function(e){r=R(r||{},e),s&&r&&s.sendMessage({handler:We.UPDATE_PARAMS,params:r})}}},e.handleOneTapEvents=function(n,r,o){var i,a,s=n.params.uuid;switch(n.handler){case M.ERROR:var c={uuid:s,error:n.params.message};o.callback({type:n.handler,payload:c}),t.handleError(n.params);break;case Be.AUTH_DATA_LOADED:r.sendMessage({handler:Be.RESIZE_FRAME,params:{uuid:s}});break;case Be.LOGIN_SUCCESS:o.callback({type:n.handler,provider:"vk",payload:n.params});break;case Be.SHOW_CAPTCHA:var u=new Ue(s,{captcha_sid:n.params.captcha_sid,captcha_img:n.params.captcha_img,is_refresh_enabled:n.params.is_refresh_enabled},null===(i=o.options)||void 0===i?void 0:i.scheme);u.show().then((function(e){r.sendMessage({handler:Ke.CAPTCHA_SUCCESS,params:X({uuid:s},e)})})).catch((function(){r.sendMessage({handler:Ke.CAPTCHA_FAIL,params:{uuid:s}}),u.destroy()}));break;case He.SHOW_DATA_POLICY:e.userDataPolicy(s,null===(a=o.options)||void 0===a?void 0:a.scheme).show().then((function(){o.callback({type:He.DATA_POLICY_RESULT,payload:{uuid:s,policyAccepted:!0}})})).catch((function(){o.callback({type:He.DATA_POLICY_RESULT,payload:{uuid:s,policyAccepted:!1}})}));break;case Be.AUTHORIZE_NEEDED:var l={scope:n.params.scope,device_id:n.params.device_id},p=new rt(l);p.open({}).catch((function(e){console.error(e),p.close()}));var d=function e(t){var n=t.params,r=n.uuid,i=n.code,a=n.code_verifier,s=r&&i?Be.LOGIN_SUCCESS:Be.LOGIN_FAILED;o.callback({type:s,provider:"vk",payload:{code:i,state:r,code_verifier:a}}),p.close(),p.off(Ye.SUCCESS,e),p.off(Ye.FAILED,e)};p.on(Ye.SUCCESS,d),p.on(Ye.FAILED,d);break;case Be.FULL_AUTH_NEEDED:case Be.PHONE_VALIDATION_NEEDED:o.callback({type:n.handler,payload:{uuid:s}})}},e.userDataPolicy=function(e,n){var r,o=Ze.validate({uuid:e});!o.isValid()&&console.error(o.error());var i,a=window.innerHeight,s=function(){r&&(r.style.display="none")},c=new we,u=function(){r&&r.remove(),i&&i.destroy()};r=N("",{properties:{height:a+"px"},cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      min-height: 100vh;\n      border: none;\n      z-index: 99999;\n      color-scheme: none;\n    "}),document.body.appendChild(r);var l=function(o){switch(o.handler){case M.ERROR:t.handleError(o.params);break;case He.HIDE_DATA_POLICY:s(),c.resolve(void 0),u();break;case He.SHOW_CAPTCHA:var a=new Ue(e,{captcha_sid:o.params.captcha_sid,captcha_img:o.params.captcha_img,is_refresh_enabled:o.params.is_refresh_enabled},n);a.show().then((function(t){i.sendMessage({handler:Ke.CAPTCHA_SUCCESS,params:X({uuid:e},t)}),r.style.display="block"})).catch((function(){i.sendMessage({handler:Ke.CAPTCHA_FAIL,params:{uuid:e}}),a.destroy()})),s();break;default:s(),c.reject(),u()}};return Ae.fetchDomain().then((function(){Ie({origin:location.protocol+"//"+location.host,uuid:e,scheme:n||null},"user_data_policy").then((function(e){r.src=e})),(i=new Ce({iframe:r,origin:"https://"+Ae.get().connectDomain})).onMessage(l)})),{show:function(){return r.style.display="block",new Promise((function(e){c.start(),c.get().then((function(t){e(t)}))}))},hide:s,destroy:u}},e.userPolicyAgreements=function(n,r){var o,i,a,s=new we;a=window.innerHeight,o=N("",{properties:{height:a+"px"},cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+a+"px;\n      min-height: "+a+"px;\n      border: none;\n      z-index: 99999;\n      color-scheme: none;\n    "}),document.body.appendChild(o);var c=function(){o&&(o.remove(),o=null),i&&i.destroy()},u=function(){o&&(o.style.display="none")},l=function(a){switch(a.handler){case M.ERROR:t.handleError(a.params);break;case Ge.ACCEPT_POLICY_AGREEMENTS:u(),s.resolve({accepted:!0}),c();break;case Ge.DECLINE_POLICY_AGREEMENTS:u(),s.resolve({accepted:!1}),c();break;case Ge.GET_CAPTCHA:var l=new Ue(n,{captcha_sid:a.params.captcha_sid,captcha_img:a.params.captcha_img,is_refresh_enabled:a.params.is_refresh_enabled},r);l.show().then((function(e){i.sendMessage({handler:Ge.CAPTCHA_SUCCESS,params:X({uuid:n},e)}),o.style.display="block"})).catch((function(){i.sendMessage({handler:Ge.CAPTCHA_FAIL,params:{uuid:n}}),l.destroy()})),u();break;case Ge.SHOW_DATA_POLICY:u();var p=function(){o.style.display="block"};e.userDataPolicy(n,r).show().then(p).catch(p);break;case Ge.POLICY_AGREEMENTS_ERROR:case Ge.HIDE_POLICY_AGREEMENTS:default:s.reject(),c()}};return Ae.fetchDomain().then((function(){Ie({origin:location.protocol+"//"+location.host,uuid:n,scheme:r||null},"user_policy_agreements").then((function(e){o.src=e,(i=new Ce({iframe:o,origin:"https://"+Ae.get().connectDomain})).onMessage(l)}))})),{show:function(){return o.style.display="block",new Promise((function(e){s.start(),s.get().then((function(t){e(t)}))}))},hide:u,destroy:c}},e.userVisibleAuth=function(t){return Ae.fetchDomain().then((function(){var n=S(),r=Ae.get(),i=X(X({origin:location.protocol+"//"+location.host,uuid:n,debug:r._debug?1:null,localhost:r._localhost?1:null},K(t,["screen","source"])),{scheme:null==t?void 0:t.scheme}),a=Pe(null==t?void 0:t.action);a&&(i.action=a);var s=De(null==t?void 0:t.entry);return s&&(i.initial_stats_info=s),Ie(i).then((function(t){e.flags&&(t=t+"#"+P(e.flags));var r=screen.height/2-280,i=screen.width/2-410,a=window.open(t,"_blank","top="+r+",left="+i+",width=820,height=560,location");if(!a){var s=ae(oe(U[U.CONNECT_WINDOW_NOT_OPENED],U.CONNECT_WINDOW_NOT_OPENED,"Connect window was not opened."));return Promise.reject(s)}return new Promise((function(e,t){var r=setInterval((function(){if(!a||a.closed){window.removeEventListener("message",i),clearInterval(r);var e=ae(oe(U[U.CONNECT_WINDOW_CLOSED],U.CONNECT_WINDOW_CLOSED,"Connect window was closed."));t(e)}}),1e3);function i(s){var c;if(s.source===a&&a){var u=null===(c=s.data.action)||void 0===c?void 0:c.split(n)[0];if(Object.values(je).includes(u))if(window.removeEventListener("message",i),clearInterval(r),function(e){for(var t=0;t<o.length;t++){var n=o[t];if(e.slice(e.length-n.length)===n)return!0}return!1}(s.origin))if(s.data.action===je.VK_CONNECT_RESPONSE+n){var l=s.data.payload;a.close(),l.error?(d=ae(oe(U[U.CONNECT_CLIENT_SDK_ERROR],U.CONNECT_CLIENT_SDK_ERROR,function(e){return e.error+";"+e.errorCode}(l.error))),t(d)):e({provider:"vk",payload:l})}else if(s.data.action===je.OAUTH_CALLBACK+n)e({provider:s.data.payload.name}),a.close();else if(s.data.action===je.SKIP_CALLBACK+n){var p=s.data.payload.redirectURL;p&&(window.location.href=p),a.close()}else s.data.action===je.BIND_OK_ACCOUNT+n&&(e(s.data.payload),a.close());else{a.close();var d=ae(oe(U[U.CONNECT_DOMAIN_NOT_ALLOWED],U.CONNECT_DOMAIN_NOT_ALLOWED,function(e){return'URL domain "'+e+'" is not allowed.'}(s.origin)));t(d)}}}window.addEventListener("message",i)}))}))}))},e.redirectAuth=function(e){var t=qe.validate(e);!t.isValid()&&console.error(t.error());var n=e.code_verifier?{code_challenge:V(e.code_verifier),code_challenge_method:"s256"}:{},r=S(),o=X(X(X({redirect_uri:e.url,uuid:r},K(e,["screen","source"])),{scheme:null==e?void 0:e.scheme}),n),i=Pe(null==e?void 0:e.action);i&&(o.action=i);var a=De(null==e?void 0:e.entry);a&&(o.initial_stats_info=a),(null==e?void 0:e.state)&&(o.redirect_state=e.state),Ie(o).then((function(e){location.assign(e)}))},e.logout=function(){return Ae.fetchDomain().then((function(){var e=Ae.get(),t=e.connectDomain,n=e.appId,r=e.superAppTokenV2;if(!r)return Promise.reject(B("superappToken","SuperappToken is undefined"));var o=P({origin:location.protocol+"//"+location.host,host_app_id:n,superapp_token:r}),i=fetch("https://"+t+"/logout?"+o,{credentials:"include"});return Ae.events.emit(M.LOGOUT),Ae.setSuperAppToken(""),Ae.setSuperAppToken("",{version:2}),i}))},e}(),it=["open_account"];!function(){function e(){}e.open=function(e){var t=le.validate({token:e.action.token});return!t.isValid()&&console.error(t.error()),Ae.fetchDomain().then((function(){var t,n=S(),r=Ae.get(),o=X({origin:location.protocol+"//"+location.host,uuid:n,debug:x(r._debug,0),localhost:x(r._localhost,0)},K(e,["screen","source"])),i=(t=null==e?void 0:e.action)&&it.includes(t.name)?btoa(JSON.stringify(t)):"";return i&&(o.action=i),function(e){return Ae.fetchDomain().then((function(){var t=Ae.get(),n=t.appId,r=t.connectDomain,o=t.appSettings,i=t._debug,a=t._localhost,s=X({app_id:n,response_type:"silent_token",v:"1.60.6",debug:i?1:null,localhost:a?1:null},e);o&&I(o)&&(s.app_settings=k(o));var c=P(s);return Promise.resolve("https://"+r+"/open_account?"+c)}))}(o).then((function(e){if(!window.open(e,"_blank")){var t=ae(oe(U[U.CONNECT_WINDOW_NOT_OPENED],U.CONNECT_WINDOW_NOT_OPENED,"Connect window was not opened."));return Promise.reject(t)}return Promise.resolve()}))}))}}();!function(e){e.INTERNAL_RESIZE="VKSDKMessengerInternalResize",e.INTERNAL_LOGOUT="VKSDKMessengerInternalLogout"}(et||(et={})),function(e){e.CLOSE_CHAT="VKSDKMessengerCloseChat"}(tt||(tt={}));var at,st=new ue({config:[{rule:ne,errorText:W("config")}]}),ct={styles:{bottom:"0",right:"0",zIndex:99999}};!function(e){function t(t){var n=e.call(this)||this;n.config=ct,n.cssText="\n    border: none;\n    display: none;\n    position: fixed;\n    color-scheme: none;\n  ",n.updateStyles=function(){if(n.iframe){var e=n.config.styles,t=isFinite(e.zIndex)?e.zIndex:999999;n.iframe.style.zIndex=""+t,n.iframe.style.bottom=e.bottom,n.iframe.style.right=e.right}};var r=st.validate({config:t});return!r.isValid()&&console.error(r.error()),n.updateConfig(t),n}Y(t,e),t.prototype.handleBridgeMessage=function(t){var n=this;switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case M.GET_CAPTCHA:var r=t.params.uuid,o=new Ue(r,{captcha_sid:t.params.captcha_sid,captcha_img:t.params.captcha_img,is_refresh_enabled:t.params.is_refresh_enabled});o.show().then((function(e){n.bridge.sendMessage({handler:M.GET_CAPTCHA+"Success",params:X({uuid:r},e)})})).catch((function(){n.bridge.sendMessage({handler:M.GET_CAPTCHA+"Fail",params:{uuid:r}}),o.destroy()}));break;case et.INTERNAL_RESIZE:this.handleInternalIframeResize(t);break;case et.INTERNAL_LOGOUT:this.handleLogout();break;case tt.CLOSE_CHAT:this.events.emit(tt.CLOSE_CHAT,t.params);break;default:return}},t.prototype.handleInternalIframeResize=function(e){var t=e.params;this.iframe.width=t.width+"px",this.iframe.height=t.height+"px"},t.prototype.handleAfterUpdateConfig=function(){this.updateStyles()},t.prototype.handleAfterCreateIframe=function(){this.updateStyles()},t.prototype.validateParams=function(e){return e.peer_id>=0?Promise.reject(B("peer_id","Peer id can`t be positive")):Promise.resolve(e)},t.prototype.getIframeUrl=function(){var e=this;return Ae.fetchDomain().then((function(){return e.getIframeUrlParams().then((function(e){var t=Ae.get().connectDomain;return Promise.resolve("https://"+t+"/messenger?"+e)}))}))}}($e);!function(e){e.SCANNED="VKSDKQRScaned",e.CLICKED="VKSDKQRClicked"}(at||(at={}));var ut,lt=new ue({container:[{rule:ne,errorText:W("container")}]}),pt=function(e){function t(t){var n=e.call(this)||this;n.getIframeContainer=function(){return n.config.container?n.config.container:window.document.body};var r=lt.validate(t);return!r.isValid()&&console.error(r.error()),(null==t?void 0:t.langId)&&!Ne.includes(null==t?void 0:t.langId)&&console.error(B("lang_id","This lang id is not allowed")),n.updateConfig(t),n}return Y(t,e),t.prototype.getIframeUrl=function(){return this.getIframeUrlParams().then((function(e){var t=Ae.get().connectDomain;return Promise.resolve("https://"+t+"/qr_auth?"+e)}))},t.prototype.getIframeUrlParams=function(){var e=this;return Ae.fetchDomain().then((function(){var t,n=Ae.get(),r=n.appId,o=n._debug,i=n._localhost;return Promise.resolve(P({scheme:(null===(t=e.params)||void 0===t?void 0:t.scheme)||null,app_id:r,origin:location.protocol+"//"+location.host,lang_id:e.config.langId||null,initial_stats_info:De(e.config.entry)||null,debug:o?1:null,localhost:i?1:null}))}))},t.prototype.handleBridgeMessage=function(t){var n=this;switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case at.CLICKED:this.events.emit(at.CLICKED);break;case at.SCANNED:this.events.emit(at.SCANNED,t.params.token);break;case M.GET_CAPTCHA:var r=t.params.uuid,o=new Ue(r,{captcha_sid:t.params.captcha_sid,captcha_img:t.params.captcha_img,is_refresh_enabled:t.params.is_refresh_enabled});o.show().then((function(e){n.bridge.sendMessage({handler:M.GET_CAPTCHA+"Success",params:X({uuid:r},e)})})).catch((function(){n.bridge.sendMessage({handler:M.GET_CAPTCHA+"Fail",params:{uuid:r}}),o.destroy()}));break;default:return}},t}($e);!function(e){e.CONTENT_IN_HEIGHT="VKSDKUserContentInHeight",e.VALIDATION_PHONE_CLOSE="VKSDKUserValidationPhoneClose"}(ut||(ut={}));var dt,ht=new ue({container:[{rule:ne,errorText:W("container")}]}),ft=new ue({canSkip:[{rule:ne,errorText:W("canSkip")}],origin:[{rule:ne,errorText:W("origin")}]});!function(e){function t(t){var n=e.call(this)||this;n.getIframeContainer=function(){return n.config.container?n.config.container:window.document.body};var r=ht.validate(t);return!r.isValid()&&console.error(r.error()),n.updateConfig(t),n}Y(t,e),t.prototype.getIframeUrl=function(){var e=X(X({redirect_uri:this.params.url,uuid:S()},K(this.params,["screen","source"])),{scheme:this.params.scheme}),t=Pe(this.params.action);t&&(e.action=t);var n=De(this.params.entry);return n&&(e.initial_stats_info=n),this.params.state&&(e.redirect_state=this.params.state),Ie(e)},t.prototype.handleBridgeMessage=function(t){switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case ut.CONTENT_IN_HEIGHT:this.events.emit(ut.CONTENT_IN_HEIGHT,t.params);break;case ut.VALIDATION_PHONE_CLOSE:this.events.emit(ut.VALIDATION_PHONE_CLOSE,t.params);break;default:return}},t.prototype.validatePhone=function(e){var t=ft.validate(e);!t.isValid()&&console.error(t.error());var n={name:"auth_validation_phone",params:{status:e.canSkip?"1":"0"}};e.sid&&(n.params.sid=e.sid),this.open({url:e.origin,scheme:e.scheme,action:n})}}($e);!function(e){e.SUCCESS="VKSDKVerificationProfileSuccess",e.CLOSE="VKSDKVerificationProfileClose"}(dt||(dt={}));var mt,vt=new ue({config:[{rule:ne,errorText:W("config")}],provider:[{rule:te,errorText:z("provider")},{rule:ne,errorText:W("provider")}]});!function(e){function t(t){var n=e.call(this)||this;n.cssText="\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9999;\n    border: none;\n    display: none;\n    color-scheme: none;\n  ";var r=vt.validate({config:t,provider:t.provider});return!r.isValid()&&console.error(r.error()),n.updateConfig(t),n}Y(t,e),t.prototype.handleBridgeMessage=function(t){switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case dt.SUCCESS:this.events.emit(dt.SUCCESS);break;case dt.CLOSE:this.close();break;default:return}},t.prototype.handleAfterUpdateConfig=function(){this.updateZIndex()},t.prototype.handleAfterCreateIframe=function(){this.updateZIndex()},t.prototype.getIframeUrlParams=function(){var e=this;return Ae.fetchDomain().then((function(){var t=Ae.get(),n=t.superAppTokenV2,r=t.appId,o=t._debug,i=t._localhost;return Promise.resolve(P(X(X({},e.params),{app:r,superapp_token:n,origin:location.protocol+"//"+location.host,debug:o?1:null,localhost:i?1:null,provider:e.config.provider})))}))},t.prototype.getIframeUrl=function(){var e=this;return Ae.fetchDomain().then((function(){return e.getIframeUrlParams().then((function(e){var t=Ae.get().connectDomain;return Promise.resolve("https://"+t+"/verification_profile?"+e)}))}))},t.prototype.updateZIndex=function(){if(this.iframe){var e=this.config.zIndex;this.iframe.style.zIndex=""+e}}}($e);!function(e){e.SUCCESS="VKSDKReverseMatchingSuccess",e.CLOSE="VKSDKReverseMatchingClose"}(mt||(mt={}));!function(e){function t(t){var n=e.call(this)||this;return n.cssText="\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9999;\n    border: none;\n    display: none;\n    color-scheme: none;\n  ",n.updateConfig(t),n}Y(t,e),t.prototype.handleBridgeMessage=function(t){switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case mt.SUCCESS:this.events.emit(mt.SUCCESS);break;case mt.CLOSE:this.close();break;default:return}},t.prototype.handleAfterUpdateConfig=function(){this.updateZIndex()},t.prototype.handleAfterCreateIframe=function(){this.updateZIndex()},t.prototype.getIframeUrlParams=function(){var e=this;return Ae.fetchDomain().then((function(){var t=Ae.get(),n=t._debug,r=t._localhost;return Promise.resolve(P(X(X({},e.params),{origin:location.protocol+"//"+location.host,debug:n?1:null,localhost:r?1:null})))}))},t.prototype.getIframeUrl=function(){var e=this;return Ae.fetchDomain().then((function(){return e.getIframeUrlParams().then((function(e){var t=Ae.get().connectDomain;return Promise.resolve("https://"+t+"/reverse_matching?"+e)}))}))},t.prototype.updateZIndex=function(){if(this.iframe){var e=this.config.zIndex;this.iframe.style.zIndex=""+e}}}($e)},11010:(e,t,n)=>{function r(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,c,"next",e)}function c(e){r(a,o,i,s,c,"throw",e)}s(void 0)}))}}n.d(t,{_:()=>o})}}]);try{stManager.done("dist/api/widgets/chunks/a83d2ad0.27470811.js")}catch(e){}