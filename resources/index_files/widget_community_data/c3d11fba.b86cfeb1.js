(self.webpackChunkvkwidgets=self.webpackChunkvkwidgets||[]).push([[3687],{7659:(t,e,s)=>{"use strict";s.d(e,{browser:()=>i,mobPlatforms:()=>a,redirectToMVK:()=>c});s(57371),s(82079);var n=s(65076),o=s(20562);const r=navigator.userAgent.toLowerCase(),i={version:(r.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[\/: ]([\d.]+)/)||[0,"0"])[1],opera:/opera/i.test(r)||/opr/i.test(r),vivaldi:/vivaldi/i.test(r),amigo:/amigo.*mrchrome soc/i.test(r),msie:/msie/i.test(r)&&!/opera/i.test(r)||/trident\//i.test(r)||/edge/i.test(r),msie6:/msie 6/i.test(r)&&!/opera/i.test(r),msie7:/msie 7/i.test(r)&&!/opera/i.test(r),msie8:/msie 8/i.test(r)&&!/opera/i.test(r),msie9:/msie 9/i.test(r)&&!/opera/i.test(r),msie_edge:/edge/i.test(r)&&!/opera/i.test(r),mozilla:/firefox/i.test(r),yabrowser:/yabrowser/i.test(r),whale:/whale/i.test(r),chrome:/chrome/i.test(r)&&!/edge/i.test(r),safari:!/chrome/i.test(r)&&/webkit|safari|khtml/i.test(r),iphone:/iphone/i.test(r),ipod:/ipod/i.test(r),iphone4:/iphone.*OS 4/i.test(r),ipod4:/ipod.*OS 4/i.test(r),ipad:/ipad/i.test(r),ios:/.+(ipod|ipad|iphone.*os)/i.test(r),android:/android/i.test(r),bada:/bada/i.test(r),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(r),msie_mobile:/iemobile/i.test(r),safari_mobile:/iphone|ipod|ipad/i.test(r),opera_mobile:/opera mini|opera mobi/i.test(r),opera_mini:/opera mini/i.test(r),mac:/mac/i.test(r),windows7:/windows nt 6.1/i.test(r),windowsVista:/windows nt 6.0/i.test(r),windowsXp:/windows nt (5.2|5.1)/i.test(r),search_bot:/(yandex|google|stackrambler|aport|slurp|msnbot|bingbot|twitterbot|ia_archiver|facebookexternalhit)/i.test(r),smart_tv:/smart-tv|smarttv/i.test(r)};const a={1:1,2:1,3:1,4:1,5:1,8:1};window,"onwheel"in document.createElement("div")||void 0!==document.onmousewheel||i.mozilla,document.createElement("div"),navigator.credentials&&navigator.credentials.preventSilentAccess&&window.vk&&vk.cma;function c(){const[t,e]=location.href.split("?"),s=new URLSearchParams(e),r={};for(let t of s)r[t[0]]=t[1];if(r){if("1"===r.m)return;if(r.force_redirect_to_mvk){delete r.force_redirect_to_mvk;const e=(0,n.toQueryString)(r);return void(window.location=t.replace(o.VK_ORIGIN_REGEX_STRICT,"https://m."+(0,o.getHostName)())+(e?"?"+e:""))}}if(o.VK_URL_REGEX.test(t)&&!new RegExp("^"+o.VK_HOST_REGEX_UNSAFE.source+"\\/@").test(t)){const e=Object.assign(r,{force_redirect_to_mvk:1}),s=t+"?"+(0,n.toQueryString)(e);window.location=s}}},65076:(t,e,s)=>{"use strict";s.d(e,{fromQueryString:()=>l,toQueryString:()=>c});let n={};const o=t=>"function"==typeof t,r=t=>Array.isArray(t),i=function(t){if(n[t])return t;try{return encodeURIComponent(t)}catch(t){return""}},a=function(t){try{return decodeURIComponent(t)}catch(e){return n[t]=1,t}};function c(t,e){const s=[];for(const e in t)if(t.hasOwnProperty(e)&&null!=t[e]&&!o(t[e]))if(r(t[e]))for(let n=0,r=0,a=t[e].length;n<a;++n)null==t[e][n]||o(t[e][n])||(s.push(i(e)+"["+r+"]="+i(t[e][n])),++r);else s.push(i(e)+"="+i(t[e]));return e||s.sort(),s.join("&")}function l(t){if(!t)return{};const e={};t=t.split("&");for(let s=0;s<t.length;s++){const n=t[s].split("=");if(n[0]){const t=a(n[1]+"");if("[]"===n[0].substr(n.length-2)){const s=a(n[0].substr(0,n.length-2));e[s]||(e[s]=[]),e[s].push(t)}else e[a(n[0])]=t}}return e}},82079:(t,e,s)=>{"use strict";s.d(e,{getCookie:()=>a,setCookie:()=>l});var n=s(48041),o=s(57458),r=s(33751),i=s(7659);function a(t){return function(){window._cookies={};const t=document.cookie.split(";"),e=/^[\s]*([^\s]+?)$/i;for(let s=0,n=t.length;s<n;s++){const n=t[s].split("=");2===n.length&&(_cookies[n[0].match(e)[1]]=unescape(n[1].match(e)?n[1].match(e)[1]:""))}}(),"https:"!==location.protocol&&"localhost"!==location.hostname&&(0,o.statlogsValueEvent)("read_unsecure_cookie",t,location.href),_cookies[t]}function c(t,e){const s=(0,n.getCookieGroups)(),o=function(){const t=a("remixcpl");if(!t)return[];const e=t.split(",");return e.forEach(((t,s)=>{e[s]=parseInt(t)})),e}();let i=t,c=null;if(!(0,n.partConfigEnabled)("need_check_allowed_cookie"))return!0;if(!isNaN(parseInt(e))&&parseInt(e)<0)return!0;"remix"===i.substr(0,5)&&(i=i.substr(5)),s.hasOwnProperty(t)?c=parseInt(s[t]):s.hasOwnProperty(i)?c=parseInt(s[i]):"q_"===i.substr(0,2)&&s.hasOwnProperty("q_")&&(c=parseInt(s.q_)),(null===c||isNaN(c))&&(0,r.logError)(`Undefined cookie group for cookie ${t} (${i})`);return 1===c||!(isNaN(c)||!o.includes(c))}function l(t,e,s,o,r="None",a=window.locDomain,l={}){if(!c(t,s))return!1;const u=t+"="+escape(e),d=l.withoutSubdomains?".":"",g="; path=/"+(a?"; domain="+d+a:""),m="https:"===location.protocol;let p=!!o;(0,n.partConfigEnabled)("cookie_secure_default_true")&&(p=!1!==o);const f=m&&p?"; secure":"",h=p&&i.browser.chrome&&parseInt(i.browser.version)>=71&&(0,n.partConfigEnabled)("cookie_class_samesite")?`; SameSite=${r}`:"";let v="";if(s){const t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3),v="; expires="+t.toGMTString()}return document.cookie=u+v+g+h+f,!0}},57371:(t,e,s)=>{"use strict";function n(t=window.browser){return!(!t.mac||t.iphone||t.ipad||t.ipod||!(navigator.maxTouchPoints>1))}s.d(e,{isIPadOS:()=>n})},57458:(t,e,s)=>{"use strict";s.d(e,{statlogsValueEvent:()=>h});var n=s(82079),o=s(20562),r=s(1934),i=s(70956),a=s(48041),c=s(76509),l=s(22168);let u,d,g,m;(0,o.isMvk)()?(u="lock_m_stats_cookie_lock",d="remixmstsl",g="lock_m_stats_cookie_locked_stats",m="remixmsts"):(u="lockkk_stats_cookie_lock",m="remixsts",d="remixstsl",g="lock_stats_cookie_locked_stats");const p=[],f={get stats(){return(r.ls.checkVersion()?JSON.parse(r.ls.get(g)):this._stats)||[]},push(t){const e=this.stats;e.push(t),r.ls.checkVersion()?r.ls.set(g,JSON.stringify(e)):this._stats=e},clear(){r.ls.checkVersion()?r.ls.remove(g):delete this._stats}};function h(t,e,...s){if(void 0===t||void 0===e)return;if(p.forEach((n=>n(t,e,...s))),(0,a.partConfigEnabled)("local_storage_statlogs_value_event")&&![c.ADBLOCK_CONFIG_KEY,l.WASM_SUPPORT_CONFIG_KEY].includes(t))return void(0,i.saveStatlogEvents)({name:t,value:e,keys:s});const o=[Math.round(Date.now()/1e3),t,e].concat(s);w((()=>{if((0,a.partConfigEnabled)("mvk_stats_cookie_soft_clean_up")){if("1"===(0,n.getCookie)(d))return void f.push(o);(0,n.setCookie)(d,"1")}v(o)}))}function v(t){let e;try{e=JSON.parse((0,n.getCookie)(m)),e=e.data}catch(t){e=[]}if(e=[...e,...f.stats],t&&e.push(t),0===e.length)return;const s=1000000001*Math.random();(0,n.setCookie)(m,JSON.stringify({data:e.slice(-100),uniqueId:s}),.01),f.clear()}function w(t,e){if(r.ls.checkVersion()){if(!0!==r.ls.get(u)){r.ls.set(u,!0);try{t()}catch(t){}return void r.ls.set(u,!1)}e||setTimeout((()=>w(t,!0)),100)}else t()}(0,a.partConfigEnabled)("mvk_stats_cookie_soft_clean_up")&&(window.addEventListener("beforeunload",(()=>{v(null)})),window.ajax&&window.ajax.onResponse((()=>{v(null)})))},48041:(t,e,s)=>{"use strict";s.d(e,{calculateTimeOffsets:()=>a,getConfigValue:()=>r,getCookieGroups:()=>i,partConfigEnabled:()=>o});var n=s(82079);function o(t){const{pe:e={}}=window.vk||{};return!!e[t]}function r(t){const{cfg:e={}}=window.vk||{};return e[t]}function i(){const{acl:t={}}=window.vk||{};return t}function a(){const t=window.vk.ts;if(t&&!window.browser.opera_mobile){const e=new Date;let s=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())/1e3-t;s-=10800,s/=60,s=s.toFixed(0),s*=60,s<-55800?s+=86400:s>37800&&(s-=86400);let o=0,r=Math.abs(s);[-12,-11,-10,-9.5,-9,-8,-7,-6,-5,-4.5,-4,-3.5,-3,-2,-1,0,1,2,3,3.5,4,4.5,5,5.5,5.75,6,6.5,7,8,8.75,9,9.5,10,10.5,11,12,12.75,13,14].forEach((t=>{const e=Math.round(3600*(t-3)),n=Math.abs(s-e);n<r&&(r=n,o=e)}));const i=(0,n.getCookie)("remixdt");return void 0!==i&&function(t){if(!0===t)return 1;return parseInt(t)||0}(i)===o||(0,n.setCookie)("remixdt",o,365),o}return 0}},60201:(t,e,s)=>{"use strict";s.d(e,{logError:()=>o});var n=s(72010);function o(t,{breadcrumb:e,environment:s,hasDummyStacktrace:o}={}){var r;const i=null==(r=(0,n.getGlobalObject)().__SENTRY__)?void 0:r.hub;if(i)return o&&t.stack&&delete t.stack,i.captureException(t,{captureContext:t=>(s&&t.setTags({module:s}),e&&t.addBreadcrumb({message:e.message,category:"custom",data:e.data}),t)})}},72010:(t,e,s)=>{"use strict";function n(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}}s.d(e,{getGlobalObject:()=>n})},14796:(t,e,s)=>{"use strict";s.d(e,{getBrowserFingerprint:()=>o});var n=s(82079);function o(){return(0,n.getCookie)("remixgp")}},72242:(t,e,s)=>{"use strict";s.d(e,{debugBufferLog:()=>u,logError:()=>a,logEvalError:()=>l,logUnknownError:()=>c});var n=s(48041),o=s(94856),r=s(54121),i=s(60201);function a(t,e={}){var s;if(null==(s=window)?void 0:s.Raven){const{breadcrumb:s,environment:n}=e;s&&window.Raven.captureBreadcrumb({message:s.message,category:r.customBreadcrumbCategory,data:s.data}),n?window.Raven.captureException(t,{environment:n}):window.Raven.captureException(t)}(0,n.partConfigEnabled)("eager_sentry_web")&&!(0,n.partConfigEnabled)("eager_sentry_web_classic")?(0,i.logError)(t,e):(0,o.logError)(t,e)}function c(t){if(t instanceof Error)return void a(t);let e="unknown error";if("string"==typeof t&&(e=t),"object"==typeof t&&null!==t&&"message"in t){const{message:s}=t;"string"==typeof s&&(e=s)}a(new Error(e))}function l(t,e){e&&e.length>2e3&&(e=`${e.slice(0,1e3)}...${e.slice(-1e3)}`),t.message+=`: ${e}`,a(t)}function u(t){return a(t,{environment:"debugLog"})}},77382:(t,e,s)=>{"use strict";s.d(e,{isStuckError:()=>f,pruneRequestFromStuckErrors:()=>h});var n,o,r=s(34788),i=s(48041),a=s(27330),c=s(49146);const l="mvk"===(null==(o=window.vk)||null==(n=o.statsMeta)?void 0:n.platform)&&(0,i.partConfigEnabled)("mute_mvk_err_peaks"),u=s(11317),d=10,g=l&&u(d),m=l&&u(d,5e3),p=({value:t,stacktrace:e,file:s,page:n})=>[t,e.join(""),s,n].join("_"),f=t=>{if(!l||!m||!g)return!1;const e=p(t);let[s,n]=[g.get(e)||0,m.get(e)||0];return g.set(e,++s),m.set(e,++n),n>=d||s>=50},h=l?t=>{var e;const s=Date.now(),n="jsErrorLogs",o=(0,a.getWebStatsStringValue)(n,t);let i;if(((null==(e=o.match(new RegExp("},{","g")))?void 0:e.length)||0)<d)return t;try{i=JSON.parse(o)}catch(t){(0,c.logProcessingTime)(1,"dedupe-fail")}if(!i)return t;const l=Object.values(i.reduce(((t,e)=>{const s=p(e),n=t[s]||[];return(0,r._)({},t,{[s]:n.length<d?n.concat(e):n})}),{})),u=t.replace(`"${n}":${o}`,`"${n}":${JSON.stringify([].concat.apply([],l))}`),g=Date.now()-s;return g>16&&(0,c.logProcessingTime)(g,"dedupe"),u}:t=>t},33751:(t,e,s)=>{"use strict";s.d(e,{debugBufferLog:()=>n.debugBufferLog,logError:()=>n.logError,logEvalError:()=>n.logEvalError});s(84819);var n=s(72242)},84819:(t,e,s)=>{"use strict";s(70956),s(77382)},1934:(t,e,s)=>{"use strict";s.d(e,{ls:()=>c});var n=s(91686);function o(){try{return void 0!==window.localStorage&&null!==window.localStorage&&void 0!==window.JSON}catch(t){return!1}}function r(t,e){if(void 0===t)return!1;a(t);try{return n.vkLocalStorage.setItem(t,JSON.stringify(e))}catch(t){return!1}}function i(t){if(void 0===t)return!1;try{return JSON.parse(n.vkLocalStorage.getItem(t))}catch(t){return!1}}function a(t){try{n.vkLocalStorage.removeItem(t)}catch(t){}}const c={checkVersion:o,remove:a,get:i,set:r},l=t=>void 0!==t?`${t}_@id:${window.vk.id}`:void 0,u=t=>(...e)=>{const[s,...n]=e,o=[l(s),...n];return t(...o)},d={checkVersion:o,remove:u(a),get:t=>{const e=u(i)(t);if(null===e){const e=i(t);if(null!==e)return d.set(t,e),a(t),e}return e},set:u(r)}},54121:(t,e,s)=>{"use strict";var n,o;s.d(e,{PROTECTED_MODULE_NAME_TAG:()=>r,customBreadcrumbCategory:()=>a,topErrorModuleName:()=>i}),function(t){t.SERVICE_WORKER="service_worker",t.EXTERNAL="external",t.UNKNOWN="unknown"}(n||(n={})),function(t){t.ERROR_OF_EXTENSION="ErrorOfExtension",t.KNOWN_ISSUE="KnownIssue"}(o||(o={}));const r="__protectedModuleName",i="genericVkError",a="custom";["chrome","moz","safari","safari-web"].map((t=>`${t}-extension://`))},94856:(t,e,s)=>{"use strict";s.d(e,{logError:()=>r});var n=s(20562),o=s(54121);function r(t,{breadcrumb:e,environment:s,hasDummyStacktrace:r}={}){var i,a,c,l;const u=(0,n.getGlobalObject)(),d=null==(a=u)||null==(i=a.__SENTRY__)?void 0:i.hub;if("function"==typeof(null==(c=d)?void 0:c.captureException))return r&&"object"==typeof t&&(null==(l=t)?void 0:l.stack)&&delete t.stack,d.captureException(t,{captureContext:t=>{var n;const r=s||(null==(n=u.cur)?void 0:n.module);return r&&t.setTags({module:r,[o.PROTECTED_MODULE_NAME_TAG]:!0}),e&&t.addBreadcrumb({message:e.message,category:o.customBreadcrumbCategory,data:e.data}),t}})}},20562:(t,e,s)=>{"use strict";s.d(e,{VK_DOMAIN_REGEX:()=>d,VK_HOST_REGEX_GROUP_UNSAFE:()=>l,VK_HOST_REGEX_UNSAFE:()=>c,VK_ORIGIN_PREFIX_REGEX:()=>m,VK_ORIGIN_REGEX_STRICT:()=>g,VK_POSSIBLE_SITE_HOSTS:()=>o,VK_SITES_REGEX_SOURCE_UNSAFE:()=>a,VK_SITE_REGEX_SOURCE_UNSAFE:()=>i,VK_URL_REGEX:()=>p,VK_URL_REGEX_STRICT:()=>f,getGlobalObject:()=>_,getHostName:()=>w,isMvk:()=>h,isPWA:()=>v});s(34788);const n=t=>t.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"),o=["vk.com","vk.ru",w()].filter(((t,e,s)=>s.indexOf(t)===e)),r=o.concat(["vkontakte.ru","vk.me","userapi.com"]),i=n(w()),a=o.map(n).join("|"),c=new RegExp("("+r.map(n).join("|")+")"),l=new RegExp(r.map(n).join("|")),u=(new RegExp("^"+c.source+"$"),new RegExp(`([a-zA-Z0-9\\.\\_\\-]+\\.)?${c.source}`)),d=new RegExp("^"+u.source+"$"),g=(new RegExp(`^(https?:\\/\\/)?${u.source}$`),new RegExp(`^(https?:\\/\\/)${u.source}$`)),m=new RegExp(`^(https?:\\/\\/)${u.source}`),p=new RegExp(`^(https?:\\/\\/)?${u.source}($|\\/(.*))`),f=new RegExp(`^(https?:\\/\\/)${u.source}($|\\/(.*))`);function h(){return!!window.isMVK}function v(){var t,e,s;return null==(s=window.vk)||null==(e=s.platform)||null==(t=e.startsWith)?void 0:t.call(e,"pwa")}function w(){var t;return(null==(t=_().vk)?void 0:t.__domain)||"vk.com"}function _(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}}},91686:(t,e,s)=>{"use strict";s.d(e,{bestAvailableStorage:()=>h,getSessionStorage:()=>g,isStorageAvailable:()=>a,vkLocalStorage:()=>u,vkSessionStorage:()=>m});class n{setItem(t,e){this.data[t]=String(e)}removeItem(t){delete this.data[t]}clear(){this.data={}}get length(){return Object.keys(this.data).length}key(t){return Object.keys(this.data)[t]}constructor(){this.data={},this.getItem=t=>this.data.hasOwnProperty(t)?this.data[t]:null,this.keys=()=>Object.keys(this.data)}}const o="vk-ls-dummy",r=Math.random().toString(),i={localStorage:null,sessionStorage:null};function a(t){if(null===i[t])try{const e=window[t];e.setItem(o,r),i[t]=r===e.getItem(o),e.removeItem(o)}catch(e){i[t]=!1}return i[t]}let c;function l(){return c||(c=a("localStorage")?window.localStorage:new n,c)}const u={setItem:(t,e)=>l().setItem(t,e),getItem:t=>l().getItem(t),removeItem:t=>l().removeItem(t),clear:()=>l().clear(),length:()=>l().length,key:t=>l().key(t),keys(){const t=l();return t instanceof n?t.keys():Object.keys(t)},getPrefixedKeys:t=>u.keys().filter((e=>e.startsWith(t)))};let d;function g(){return d||(d=a("sessionStorage")?window.sessionStorage:new n,d)}const m={setItem:(t,e)=>g().setItem(t,e),getItem:t=>g().getItem(t),removeItem:t=>g().removeItem(t),clear:()=>g().clear(),length:()=>g().length,key:t=>g().key(t),keys(){const t=g();return t instanceof n?t.keys():Object.keys(t)},getPrefixedKeys:t=>m.keys().filter((e=>e.startsWith(t)))};let p;function f(){return p||(p=a("localStorage")?window.localStorage:a("sessionStorage")?window.sessionStorage:new n,p)}const h={setItem:(t,e)=>f().setItem(t,e),getItem:t=>f().getItem(t),removeItem:t=>f().removeItem(t),clear:()=>f().clear(),length:()=>f().length,key:t=>f().key(t),keys(){const t=f();return t instanceof n?t.keys():Object.keys(t)},getPrefixedKeys:t=>h.keys().filter((e=>e.startsWith(t)))}},3770:(t,e,s)=>{"use strict";s.d(e,{saveStats:()=>y});var n=s(34788),o=s(27330),r=s(9535),i=s(49146),a=s(20562),c=s(64763),l=s(77382),u=s(48041),d=s(14796),g=s(94274);function m(){var t;if(!(0,u.partConfigEnabled)("web_stats_reduce_debounce"))return!1;const e=(null==(t=window.vk)?void 0:t.started)||Date.now();return Date.now()-e<=3e4}const p=()=>m()?1e3:1e4,f=()=>m()?5e3:2e4;let h,v=0;const w=()=>p()*Math.pow(v,.5),_=()=>!(Date.now()-(0,o.getLastSendTime)()>f()+w()),S=()=>Math.max(0,(0,o.getLastSendTime)()+(m()?2e3:2e4)-Date.now()),k=()=>{window.__isSendingWebStats||h||(h=window.setTimeout((()=>{const t=(0,o.getWebStatDataLs)();h=void 0,t.length>o.emptyStatsDataLs.length&&y(t)}),Math.max(Math.min(S(),p()),Math.max(0,(0,o.getLastSendTime)()+f()-Date.now()+w()))))},b=t=>{let e="";if((0,u.partConfigEnabled)("web_stats_device_id")){const t=new URLSearchParams,s=(0,d.getBrowserFingerprint)();s&&t.set("device_id",s),e=t.toString()}const s=`${window.vk.wsTransport}/web-stats/${window.vk.statsMeta.st?"s":"p"}${e&&`?${e}`}`,n=t.length>i.MAX_BODY_SIZE;let r=n?(0,g.getMaximumWebStats)(t):t,m=!1;if(!r)return window.__isSendingWebStats=!1,(0,o.clearLsData)();function p(e){const s=Date.now();window.__isSendingWebStats=!1,e<500&&(n&&200===e?Object.keys((0,o.getEmptyStatsData)()).forEach((t=>(0,c.pullFromWebStats)(t,r))):(0,o.clearLsData)(),v=0,m=!0),(n||400===e)&&(0,i.logProcessingTime)(Date.now()-s,`${n?"prune":"clean"}${400===e?"-fail":""}`,`${t.length>>>20}M ${r.length>>>20}M`),k()}function f(){const t=new XMLHttpRequest;t.withCredentials=s.includes(`tau.${(0,a.getHostName)()}`),t.onreadystatechange=()=>{t.readyState===XMLHttpRequest.DONE&&p(t.status)},t.onerror=()=>{window.__isSendingWebStats=!1,!m&&(0,o.clearLsData)()},t.open("POST",s,!0),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.send(r)}r=(0,l.pruneRequestFromStuckErrors)((0,i.appendStatsMeta)(++v,r)),(0,i.canSendBeacon)()?(0,i.sendBeacon)(s,r).then((()=>p(200))).catch((()=>f())):f()},E=(t,e)=>{var s;const n=e=>setTimeout((()=>t()),e);return(null==(s=e)?void 0:s.force)?n(0):window.requestIdleCallback?window.requestIdleCallback((()=>n(p())),{timeout:p()/2}):n(p())};function y(t,e){var s;const a=t.length>=i.MAX_BODY_SIZE,c=(null==(s=e)?void 0:s.force)||a;if(t.length<=o.emptyStatsDataLs.length)(0,r.logWebStatsEvent)("WebStats empty data.","");else{if(!window.__isSendingWebStats)return c||h||!_()?(window.__isSendingWebStats=!0,E((()=>{const t=(0,o.getWebStatDataLs)();if(t.length>o.emptyStatsDataLs.length&&(c||!_()))return(0,o.setLastSendTime)(),b(t);clearTimeout(h),window.__isSendingWebStats=!1,h=void 0}),(0,n._)({},e,{force:c}))):((0,r.logWebStatsEvent)("WebStats delayed.",h),k());(0,r.logWebStatsEvent)("WebStats sending.",window.__isSendingWebStats)}}},94274:(t,e,s)=>{"use strict";s.d(e,{getMaximumWebStats:()=>r});var n=s(27330),o=s(49146);const r=t=>{const e=Date.now(),s=t=>{var e;return`{${null==(e=t)?void 0:e.map((([t,e])=>`"${t}":${e}`)).join(",")}}`},[r,i]=Object.keys((0,n.getEmptyStatsData)()).reduce(((e,s)=>{const o=(0,n.getWebStatsStringValue)(s,t);return"[]"===o?e:[...e,[s,o]]}),[]).sort((([,t],[,e])=>e.length-t.length)).reduce((([t,e],[n,r])=>{const i=[[n,r]];return r.length+s(t).length<o.MAX_BODY_SIZE?[t.concat(i),e]:[t,e.concat(i)]}),[[],[]]),a=s(r);if((0,o.logProcessingTime)(Date.now()-e,"chunk"),Date.now()-e<500&&i[0]&&a.length<.1*o.MAX_BODY_SIZE){const t=Date.now();try{const e=((t,e)=>{const[s,n]=e,r=`{"${s}":[${JSON.parse(n).reduce(((e,s,n)=>e.length<o.MAX_BODY_SIZE-t.length?`${e}${0===n?"":","}${JSON.stringify(s)}`:e),"")}]}`;return"{}"===t?r:(0,o.concatJSONS)(t,r)||t})(a,i.reverse()[0]);return(0,o.logProcessingTime)(Date.now()-t,"batch"),e}catch(e){return(0,o.logProcessingTime)(Date.now()-t,"batch-fail"),""}}return a}},70956:(t,e,s)=>{"use strict";s.d(e,{saveCustomStats:()=>n.saveCustomStats,saveJsErrorLogs:()=>n.saveJsErrorLogs,saveNetworkStats:()=>n.saveNetworkStats,saveProductionStats:()=>n.saveProductionStats,saveStatlogEvents:()=>n.saveStatlogEvents});var n=s(64763)},49146:(t,e,s)=>{"use strict";s.d(e,{MAX_BODY_SIZE:()=>a,appendStatsMeta:()=>u,canSendBeacon:()=>g,concatJSONS:()=>l,logProcessingTime:()=>m,sendBeacon:()=>d});var n=s(34788),o=s(20224),r=s(57458),i=(s(77382),s(20562));s(48041);const a=1.8*Math.pow(10,6),c=t=>t.startsWith("{")&&t.endsWith("}"),l=(t,e)=>[t,e].every(c)?`${t.slice(0,-1)},${e.substring(1)}`:"{}",u=(t,e)=>{const s=window.vk,{id:r,statsMeta:{st:i,platform:a}}=s,u=(0,o._)(s.statsMeta,["st","platform"]),{item_id:d,item_owner_id:g,item_type:m}=window.cur;return l(JSON.stringify((0,n._)({id:r,st:i,platform:a,attempt:t,signTime:u.time,sign:u.hash},d&&{item_id:d},m&&{item_type:m},g&&{item_owner_id:g})),c(e)?e:"{}")};function d(t,e){try{if(!navigator.sendBeacon(t,e))return Promise.reject(new Error("Beacon not sent"))}catch(t){return Promise.reject(new Error("Beacon fail"))}return Promise.resolve()}function g(){return"sendBeacon"in navigator&&!window.vk.wsTransport.includes(`tau.${(0,i.getHostName)()}`)}function m(t,e,s){(0,r.statlogsValueEvent)("web_stats_batching_time",t,window.vk.statsMeta.platform,e,s)}},64763:(t,e,s)=>{"use strict";s.d(e,{pullFromWebStats:()=>c,saveCustomStats:()=>p,saveJsErrorLogs:()=>u,saveNetworkStats:()=>m,saveProductionStats:()=>g,saveStatlogEvents:()=>d});var n=s(27330),o=s(9535),r=s(48041),i=s(3770),a=s(91686);const c=(t,e)=>{const s=(0,n.getWebStatsStringValue)(t,e);if("[]"!==s){const t=(0,n.getWebStatDataLs)().replace(s.slice(1,-1),"").replace(/\[\,/,"[");(0,n.writeLocked)((()=>a.vkLocalStorage.setItem(n.lsDataKey,t)))}},l=(t,e,s,r)=>{const c=((t,e)=>{const s=(0,n.getWebStatsStringValue)(t);return(0,n.getWebStatDataLs)().replace(`"${t}":${s}`,`"${t}":${s.replace(/]$/,`${"[]"===s?"":","}${JSON.stringify(e)}]`)}`)})(e,s);(0,n.writeLocked)((()=>{a.vkLocalStorage.setItem(n.lsDataKey,c),(0,i.saveStats)(c,r)})),(0,o.logWebStatsEvent)(t,s)},u=t=>l("saveJsErrorLogs","jsErrorLogs",t),d=({name:t,value:e,keys:s=[]})=>{const n=[Math.round(Number(Date.now())/1e3),t,e,...s];return(0,r.partConfigEnabled)("web_stats_transport_debugger")&&console.log("Data was transformed!"),l("saveStatlogEvents","statlogEvents",n)},g=(t,e)=>l("saveProductionStats","productionStats",t,e),m=t=>l("saveNetworkStats","networkStats",t),p=t=>l("saveCustomStats","customStats",t)},9535:(t,e,s)=>{"use strict";s.d(e,{logWebStatsEvent:()=>o});var n=s(48041);function o(t,e){(0,n.partConfigEnabled)("web_stats_transport_debugger")&&console.log(`[new transport debug] ${t}`,e)}},27330:(t,e,s)=>{"use strict";s.d(e,{clearLsData:()=>p,emptyStatsDataLs:()=>u,getEmptyStatsData:()=>l,getLastSendTime:()=>h,getWebStatDataLs:()=>g,getWebStatsStringValue:()=>m,lsDataKey:()=>i,setLastSendTime:()=>f,writeLocked:()=>d});var n=s(91686),o=s(9535);const r=(0,s(20562).isMvk)()?"mvk":"web",i=`XHR_STATS_TRANSPORT_DATA_${r}`,a=`XHR_STATS_TRANSPORT_META_${r}`,c=`XHR_STATS_TRANSPORT_DATA_LOCK_${r}`,l=()=>({jsErrorLogs:[],statlogEvents:[],productionStats:[],storyViewStats:[],networkStats:[],customStats:[],webPerfStats:[],benchmarkMainStats:[]}),u=JSON.stringify(l());function d(t){if("locked"!==n.vkSessionStorage.getItem(c)){(0,o.logWebStatsEvent)("writeLocked","lock"),n.vkSessionStorage.setItem(c,"locked");try{t()}catch(t){}return(0,o.logWebStatsEvent)("writeLocked","free"),void n.vkSessionStorage.setItem(c,"free")}setTimeout((()=>d(t)),100)}const g=()=>n.vkLocalStorage.getItem(i)||u,m=(t,e=g())=>{var s,n;const o=Object.keys(l()).filter((e=>e!==t)).join("|"),r=(null==(n=e)||null==(s=n.match(new RegExp(`"${t}":(\\[.*?\\])(?:,"(${o})":\\[|}$)`)))?void 0:s[1])||"";return(i=r).startsWith("[")&&i.endsWith("]")?r:"[]";var i};function p(t){t&&(0,o.logWebStatsEvent)("WebStats cleared. "+(t?"Reason: LS is broken.":""),t),d((()=>n.vkLocalStorage.setItem(i,"")))}function f(t=Number(new Date)){n.vkSessionStorage.setItem(a,t.toString())}function h(){return parseInt(`${n.vkSessionStorage.getItem(a)||0}`)}},76509:(t,e,s)=>{"use strict";s.d(e,{ADBLOCK_CONFIG_KEY:()=>n});const n="unique_adblock_users"},22168:(t,e,s)=>{"use strict";s.d(e,{WASM_SUPPORT_CONFIG_KEY:()=>n});const n="users_wasm_support"},11317:function(t){t.exports=function(){"use strict";class t{constructor(t=0,e=0){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.size=0,this.ttl=e}has(t){return t in this.items}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const e=this.items[t];delete this.items[t],this.size--,null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this}evict(){const t=this.first;return delete this.items[t.key],this.first=t.next,this.first.prev=null,this.size--,this}get(t){let e;if(this.has(t)){const s=this.items[t];this.ttl>0&&s.expiry<=(new Date).getTime()?this.delete(t):(e=s.value,this.set(t,e,!0))}return e}keys(){return Object.keys(this.items)}set(t,e,s=!1){let n;if(s||this.has(t)){if(n=this.items[t],n.value=e,!1===s&&(n.expiry=this.ttl>0?(new Date).getTime()+this.ttl:this.ttl),this.last!==n){const t=this.last,e=n.next,s=n.prev;this.first===n&&(this.first=n.next),n.next=null,n.prev=this.last,t.next=n,null!==s&&(s.next=e),null!==e&&(e.prev=s)}}else this.max>0&&this.size===this.max&&this.evict(),n=this.items[t]={expiry:this.ttl>0?(new Date).getTime()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},1==++this.size?this.first=n:this.last.next=n;return this.last=n,this}}return function(e=1e3,s=0){if(isNaN(e)||e<0)throw new TypeError("Invalid max value");if(isNaN(s)||s<0)throw new TypeError("Invalid ttl value");return new t(e,s)}}()},34788:(t,e,s)=>{"use strict";function n(){return n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},n.apply(this,arguments)}s.d(e,{_:()=>n})},20224:(t,e,s)=>{"use strict";function n(t,e){if(null==t)return{};var s,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)s=r[n],e.indexOf(s)>=0||(o[s]=t[s]);return o}s.d(e,{_:()=>n,_object_without_properties_loose:()=>n})}}]);try{stManager.done("dist/api/widgets/chunks/c3d11fba.b86cfeb1.js")}catch(t){}